(()=>{(function(){if(typeof window<"u"){if(window.__pt_sdk_loaded)return;window.__pt_sdk_loaded=!0,window.__pt_sdk_version="0.2.2"}let fe="0.2.2",X="_ptq",Z="__pt_anonymous_id",D="__pt_user_id",J="__pt_session_id",G="__pt_session_last",ge=30*60*1e3,ee=200,me=5e3,pe=[25,50,75,100],te=80,n={meta:{project_id:null,cdnBase:null,tagVersion:null},config:{collectUrl:null,debug:!1,consentAnalytics:!0,trackPageViews:!0,trackClicks:!0,trackScroll:!0,trackErrors:!0,trackCards:!0,sampleRate:1,useBeaconOnUnload:!0,includeQueryHash:!1,plugins:{search:!1,ads:!1},cards:{threshold:.5,minVisibleMs:250,minWidth:120,minHeight:80,selector:"article,[data-card],[data-card-id],[data-product-id],[data-article-id],[data-content-id],.card,.product-card,.product,.item,.tile,.result,[data-testid*='card'],[data-testid*='product'],[data-testid*='item']",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe"},search:{minEmitMs:350,maxWaitMs:4500,quietDebounceMs:220,recheckIntervalMs:300,firstFallbackMs:2200,scopeSelector:"main",resultItemSelector:"article,[data-article-id],[data-content-id],[data-result],.search-result,.result,[data-testid*='result']",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe"},ads:{threshold:.5,minVisibleMs:300,minViewableMs:1e3,rescanIntervalMs:2e3,rescanTicks:15,containerSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",dataSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider]"}},sampleSeed:null,sampledIn:!0,userId:null,entryReferrer:null,currentUrl:null,previousUrl:null,webVitals:{}};function B(){return Date.now()}function T(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let i=Math.random()*16|0;return(e==="x"?i:i&3|8).toString(16)})}function j(e){return!e||typeof e!="string"||(e=e.replace(/\s+/g," ").trim(),!e)?null:(e.length>te&&(e=e.slice(0,te)+"\u2026"),e=e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[redacted_email]"),e=e.replace(/\+?\d[\d\s\-()]{7,}\d/g,"[redacted_phone]"),e)}function ne(e){try{return localStorage.getItem(e)}catch{return null}}function re(e,i){try{localStorage.setItem(e,i)}catch{}}function he(e){try{localStorage.removeItem(e)}catch{}}function ie(e){try{return sessionStorage.getItem(e)}catch{return null}}function oe(e,i){try{sessionStorage.setItem(e,i)}catch{}}function _e(){let e=ne(Z);return e||(e=T(),re(Z,e)),e}function ye(){try{let e=B(),i=Number(ie(G)||0),t=ie(J);return(!t||!i||e-i>ge)&&(t=T(),oe(J,t)),oe(G,String(e)),t}catch{return T()}}function ae(){if(n.userId)return n.userId;let e=ne(D);return n.userId=e?String(e):null,n.userId}function be(e){if(e==null||e===""){n.userId=null,he(D);return}n.userId=String(e),re(D,n.userId)}function L(){if(n.config.includeQueryHash)return window.location.href;let e=new URL(window.location.href);return e.search="",e.hash="",e.toString()}function ve(){return{ua:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screen:{w:window.screen.width,h:window.screen.height,dpr:window.devicePixelRatio||1},viewport:{w:window.innerWidth,h:window.innerHeight},sdk_version:fe,tag_version:n.meta.tagVersion||null}}function U(e,i={},t={}){let c=t.page_url!==void 0?t.page_url:L(),u=typeof t.event_ts=="number"&&Number.isFinite(t.event_ts)?t.event_ts:B(),s=t.previous_url!==void 0?t.previous_url:n.previousUrl||null,l=t.page_title!==void 0?t.page_title:document.title;return{project_id:n.meta.project_id,event_name:e,event_ts:u,anonymous_id:_e(),session_id:ye(),user_id:ae(),page_url:c,page_path:window.location.pathname,page_title:l,referrer:n.entryReferrer||document.referrer||null,previous_url:s,context:ve(),properties:i,web_vitals:n.webVitals||{}}}let V=[],Q=null;function M(...e){n.config.debug&&console.log("[pt-sdk]",...e)}function se(){return n.sampledIn&&n.config.consentAnalytics!==!1&&!!n.meta.project_id&&!!n.config.collectUrl}function O(e){se()&&(V.push(e),V.length>=20?H({reason:"size"}):we())}function we(){Q||(Q=setTimeout(()=>{Q=null,H({reason:"timer"})},me))}function Se(e,{useBeacon:i=!1}={}){if(window.__pt_debug_events=window.__pt_debug_events||[],window.__pt_debug_events.push(e),i&&navigator.sendBeacon)try{let t=new Blob([JSON.stringify(e)],{type:"application/json"}),c=navigator.sendBeacon(n.config.collectUrl,t);M("beacon sent:",c,e);return}catch(t){M("beacon failed, fallback to fetch",t)}fetch(n.config.collectUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).then(async t=>{if(t.ok)M("collect ok:",t.status,"events:",e.events?.length);else{let c=await t.text().catch(()=>"");M("collect non-2xx:",t.status,c)}}).catch(t=>M("collect failed:",t))}function H({reason:e}={}){if(!V.length||!se())return;let i=V.splice(0,V.length),t=[];for(let u=0;u<i.length;u+=ee)t.push(i.slice(u,u+ee));let c=n.config.useBeaconOnUnload&&e==="pagehide";t.forEach(u=>{let s={project_id:n.meta.project_id,sent_at:B(),events:u};Se(s,{useBeacon:c})})}function Ee(e){if(!e||!e.tagName)return null;let i=[],t=e;for(let c=0;c<4&&t&&t.tagName;c++){let u=t.tagName.toLowerCase();if(t.id){u+=`#${t.id}`,i.unshift(u);break}t.classList&&t.classList.length&&(u+="."+Array.from(t.classList).slice(0,2).join(".")),i.unshift(u),t=t.parentElement}return i.join(">")}function K(e){let i=e?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e;if(!i)return null;let t=i.closest?.("[data-elt]")||i,c=t.getAttribute?.("data-elt")||t.getAttribute?.("data-testid")||t.getAttribute?.("aria-label")||Ee(t);return j(String(c||""))||c||null}function ke(e){if(!n.config.trackClicks)return;let i=K(e.target),t=e.target?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e.target;O(U("click",{_event_id:T(),element_id:i,element_type:t?.tagName?t.tagName.toLowerCase():null,element_role:t?.getAttribute?.("role")||t?.getAttribute?.("data-role")||null,x:e.clientX,y:e.clientY,button:e.button}))}let Y=new Set;function xe(){let e=document.documentElement,i=e.scrollTop||document.body.scrollTop||0,t=e.scrollHeight||document.body.scrollHeight||0,c=e.clientHeight||1;return Math.max(0,Math.min(100,i/Math.max(1,t-c)*100))}function Ce(){if(!n.config.trackScroll)return;let e=xe();for(let i of pe)e>=i&&!Y.has(i)&&(Y.add(i),O(U("scroll",{_event_id:T(),scroll_depth:i})))}function Ae(){try{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart&&(n.webVitals.ttfb=Math.round(e.responseStart)),window.PerformanceObserver){new PerformanceObserver(l=>{l.getEntries().forEach(g=>{g.name==="first-contentful-paint"&&(n.webVitals.fcp=Math.round(g.startTime))})}).observe({type:"paint",buffered:!0}),new PerformanceObserver(l=>{let g=l.getEntries(),h=g[g.length-1];h&&(n.webVitals.lcp=Math.round(h.startTime))}).observe({type:"largest-contentful-paint",buffered:!0});let c=0;new PerformanceObserver(l=>{l.getEntries().forEach(g=>{g.hadRecentInput||(c+=g.value)}),n.webVitals.cls=Number(c.toFixed(4))}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(l=>{let g=l.getEntries()[0];g&&(n.webVitals.fid=Math.round(g.processingStart-g.startTime))}).observe({type:"first-input",buffered:!0})}}catch{}}function ce(){(n.sampleSeed===null||n.sampleSeed===void 0)&&(n.sampleSeed=Math.random());let e=typeof n.config.sampleRate=="number"?n.config.sampleRate:1,i=Math.max(0,Math.min(1,e));n.sampledIn=n.sampleSeed<i}function Ie(){if(!n.config.trackErrors)return;let e=new Set,i=s=>{try{let l=JSON.stringify(s);return l.length>800?l.slice(0,800):l}catch{return String(s)}},t=s=>{try{if(s==null)return null;let l=String(s).trim();return l?(l.length>500&&(l=l.slice(0,500)+"\u2026"),l):null}catch{return null}},c=(s,l)=>{try{let g=s||l?.fileName||l?.sourceURL||l?.scriptURL||null;if(g)return g;let h=String(l?.stack||"");if(!h)return null;let b=h.match(/(https?:\/\/[^\s)]+|file:\/\/[^\s)]+)/i);if(b&&b[1])return b[1];let C=h.match(/(\b\/[^\s)]+):\d+:\d+/);return C&&C[1]?C[1]:null}catch{return null}},u=s=>{let l=i(s);e.has(l)||(e.add(l),O(U("error",{_event_id:T(),...s})))};window.addEventListener("error",s=>{try{if(!s.message&&(s.target||s.srcElement)){let b=s.target||s.srcElement,C=b?.currentSrc||b?.src||b?.href||b?.getAttribute?.("src")||b?.getAttribute?.("href")||null,E=t(C);u({error_type:"resource",message:"resource_load_error",source_url:E,resource_url:E,resource_tag:(b?.tagName||"").toLowerCase()||null,element_id:K(b)||null,is_fatal:!1});return}let g=j(s?.message)||"js_error",h=t(c(s?.filename,s?.error))||t(s?.filename)||null;u({error_type:"js",message:g,filename:s?.filename||null,lineno:s?.lineno||null,colno:s?.colno||null,source_url:h,is_fatal:!1})}catch{u({error_type:"js",message:"js_error",source_url:null,is_fatal:!1})}},!0),window.addEventListener("unhandledrejection",s=>{try{let l=s?.reason?.message||String(s?.reason||""),g=j(l)||"unhandled_promise",h=t(c(null,s?.reason))||null;u({error_type:"unhandledrejection",message:g,source_url:h,is_fatal:!1})}catch{u({error_type:"unhandledrejection",message:"unhandled_promise",source_url:null,is_fatal:!1})}}),window.addEventListener("rejectionhandled",s=>{try{let l=s?.reason?.message||String(s?.reason||""),g=j(l)||"rejection_handled_late",h=t(c(null,s?.reason))||null;u({error_type:"rejectionhandled",message:g,source_url:h,is_fatal:!1})}catch{}})}let F=[];function $(e){e&&typeof e.init=="function"&&F.push(e)}function Te(){let e={state:n,enqueue:O,buildEvent:U,uuid:T,sanitizeText:j,getElementId:K,dbg:M,now:B};F.forEach(i=>{try{i.init(e)}catch(t){M("plugin init failed",t)}})}function le(){F.forEach(e=>{try{e.onConfigChange?.(n.config)}catch(i){M("plugin onConfigChange failed",i)}})}function Me(e,i,t){F.forEach(c=>{try{c.onRouteChange?.({kind:e,prevUrl:i,nextUrl:t})}catch(u){M("plugin onRouteChange failed",u)}})}function Re(){let e=null,i=null,t=null,c=new Set,u=new WeakSet,s=new WeakMap;function l(){return e?.state?.config?.trackCards!==!1}function g(m){try{if(!m||m.hidden)return!1;let S=window.getComputedStyle?getComputedStyle(m):null;if(S&&(S.display==="none"||S.visibility==="hidden"||S.opacity==="0")||m.getClientRects&&m.getClientRects().length===0)return!1;let _=m.getBoundingClientRect?.();return _?_.width>0&&_.height>0:!1}catch{return!0}}function h(m,S,_){try{let v=m.getBoundingClientRect?.();return v?v.width>=S&&v.height>=_:!1}catch{return!0}}function b(m){try{let _=(e.state.config.cards||{}).adExcludeSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe";return _?!!(m?.matches?.(_)||m?.closest?.(_)||m?.querySelector?.(_)):!1}catch{return!1}}function C(m){try{let _=(e.state.config.cards||{}).selector||"article,.card,.product-card",v=m?.parentElement;if(!v)return null;let x=Array.from(v.querySelectorAll(_)).filter(I=>I&&I.nodeType===1).indexOf(m);return x>=0?x+1:null}catch{return null}}function E(m){try{if(!i||!m||u.has(m))return;u.add(m),i.observe(m)}catch{}}function P(){if(!l())return;let m=e.state.config.cards||{},S=m.selector||"article,.card,.product-card",_=m.minWidth??120,v=m.minHeight??80;try{document.querySelectorAll(S).forEach(k=>{c.size>1200||!k||k.nodeType!==1||g(k)&&h(k,_,v)&&(b(k)||c.add(k))})}catch{}}function q(){if(!l()||i)return;let m=e.state.config.cards||{},S=m.threshold??.5,_=m.minVisibleMs??250;i=new IntersectionObserver(v=>{for(let k of v){let x=k.target;if(!x||b(x))continue;let I=k.intersectionRatio||0,f=k.isIntersecting&&I>=S,r=s.get(x);r||(r={timer:null,sent:!1,impression_id:null,lastRatio:0},s.set(x,r)),r.lastRatio=I,f&&!r.sent&&!r.timer&&(r.impression_id=r.impression_id||e.uuid(),r.timer=setTimeout(()=>{r.sent=!0,r.timer=null,e.enqueue(e.buildEvent("card_impression",{_event_id:e.uuid(),element_id:e.getElementId(x),card_id:e.getElementId(x),slot_position:C(x),viewport_percent:Math.round((r.lastRatio||0)*100),impression_id:r.impression_id}))},_)),!f&&r.timer&&(clearTimeout(r.timer),r.timer=null),s.set(x,r)}},{threshold:[S]}),P(),c.forEach(v=>E(v)),t=new MutationObserver(()=>{P(),c.forEach(v=>E(v))});try{t.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}}function R(){try{t?.disconnect()}catch{}t=null;try{i?.disconnect()}catch{}i=null,c.clear()}return{init(m){e=m,l()&&q()},onConfigChange(){l()?q():R()},onRouteChange(){l()&&(R(),q())}}}function Le(){let e=null,i=null,t=null,c=null,u=null,s=null,l=null,g=null,h={query:null,results_count:0,search_latency_ms:null};function b(){return!!e?.state?.config?.plugins?.search}function C(){try{if(/search/i.test(location.pathname)||/search/i.test(location.href))return!0;let r=location.search||"";return/[?&](q|query|search)=/i.test(r)}catch{return!1}}function E(r){let o=(r?.tagName||"").toLowerCase();if(o!=="input"&&o!=="textarea")return!1;let a=(r.getAttribute?.("type")||"").toLowerCase(),d=r.getAttribute?.("role")||"",y=r.getAttribute?.("name")||"",A=r.getAttribute?.("placeholder")||"";return d==="searchbox"||a==="search"||/search/i.test(y)||/search/i.test(A)}function P(r){try{let o=r?.closest?.("form")||null;if(o){let a=Array.from(o.querySelectorAll("input,textarea")).find(E);if(a)return a}return Array.from(document.querySelectorAll("input,textarea")).find(E)||null}catch{return null}}function q(r){try{if(!r)return!1;let o=(r.tagName||"").toLowerCase();if(!["button","a","div","span"].includes(o))return!1;let a=(r.getAttribute?.("type")||"").toLowerCase(),d=(r.getAttribute?.("role")||"").toLowerCase(),y=(r.getAttribute?.("aria-label")||"").toLowerCase(),A=(r.getAttribute?.("title")||"").toLowerCase(),w=(r.getAttribute?.("data-elt")||r.getAttribute?.("data-testid")||"").toLowerCase(),p=(r.innerText||"").toLowerCase(),N=`${y} ${A} ${w} ${p}`.trim();return o==="button"&&(a==="submit"||a==="button")?/search|find|go/.test(N):d==="button"||d==="link"?/search|find|go/.test(N):o==="a"?/search|find|go/.test(N):!1}catch{return!1}}function R(r){try{if(!r||r.hidden)return!1;let o=window.getComputedStyle?getComputedStyle(r):null;if(o&&(o.display==="none"||o.visibility==="hidden"||o.opacity==="0")||r.getClientRects&&r.getClientRects().length===0)return!1;let a=r.getBoundingClientRect?.();return a?a.width>0&&a.height>0:!1}catch{return!0}}function m(){try{let r=e.state.config.search||{},o=document.querySelector(r.scopeSelector||"main")||document.body||document.documentElement,a=r.resultItemSelector||"article,[data-article-id],[data-content-id]",d=r.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",y=Array.from(o.querySelectorAll(a)),A=0;for(let w of y){if(!R(w)||w.closest?.("header,nav,footer")||d&&(w.matches?.(d)||w.closest?.(d)))continue;let p=w.getBoundingClientRect?.();p&&(p.width<80||p.height<40)||A++}return A}catch{return 0}}function S(){if(s){try{s.disconnect()}catch{}s=null}l&&(clearTimeout(l),l=null),g&&(clearTimeout(g),g=null)}function _(){i=null,t=null,c=null,u=null,S()}function v(r=!1){if(!i||!t)return!1;let o=e.state.config.search||{},a=Math.max(0,e.now()-t),d=m();return r||d>0&&a>=(o.minEmitMs??350)||a>=(o.maxWaitMs??4500)?(h={query:u||"",results_count:d,search_latency_ms:Math.round(a)},e.enqueue(e.buildEvent("search",{_event_id:e.uuid(),element_id:c||"search_input",query:h.query,results_count:h.results_count,search_latency_ms:h.search_latency_ms})),_(),!0):!1}function k(){if(s)return;let r=e.state.config.search||{},o=document.querySelector(r.scopeSelector||"main")||document.body||document.documentElement;s=new MutationObserver(()=>{i&&(l&&clearTimeout(l),l=setTimeout(()=>{v(!1)},r.quietDebounceMs??220))});try{s.observe(o,{childList:!0,subtree:!0,attributes:!0})}catch{}}function x(){let r=e.state.config.search||{};if(!i||!t)return;let o=Math.max(0,e.now()-t),a=r.maxWaitMs??4500;if(!v(!1)){if(o>=a){v(!0);return}g=setTimeout(x,r.recheckIntervalMs??300)}}function I(r){if(!b())return;let o=e.sanitizeText(r?.value)||"";if(!o)return;i=e.uuid(),t=e.now(),c=e.getElementId(r)||"search_input",u=o,S(),k();let a=e.state.config.search||{};g=setTimeout(x,a.firstFallbackMs??2200)}function f(r){if(!b()||!C()||!h||(h.results_count||0)<=0)return;let o=e.state.config.search||{},a=document.querySelector(o.scopeSelector||"main")||document.body||document.documentElement,d=o.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",y=o.resultItemSelector||"article,[data-article-id],[data-content-id]",A=r.target,w=A?.closest?.("a,button,[role='link'],[role='button']")||A;if(!w||d&&(w.matches?.(d)||w.closest?.(d)))return;let p=w.closest?.(y);if(!p||d&&(p.matches?.(d)||p.closest?.(d)))return;let de=Array.from(a.querySelectorAll(y)).filter(z=>z&&R(z)&&!(d&&(z.matches?.(d)||z.closest?.(d)))).indexOf(p),Ne=de>=0?de+1:null,Pe=p.getAttribute?.("data-article-id")||p.getAttribute?.("data-content-id")||p.getAttribute?.("data-result-id")||w.getAttribute?.("href")||null;e.enqueue(e.buildEvent("search_result_click",{_event_id:e.uuid(),element_id:e.getElementId(w),query:h.query,clicked_result_id:Pe,result_rank:Ne,results_count:h.results_count}))}return{init(r){e=r,document.addEventListener("keydown",o=>{if(!b())return;let a=o.target;E(a)&&o.key==="Enter"&&I(a)},!0),document.addEventListener("submit",o=>{if(!b())return;let a=o.target;if(!a||a.nodeType!==1)return;let d=Array.from(a.querySelectorAll("input,textarea")).find(E);d&&I(d)},!0),document.addEventListener("click",o=>{if(!b())return;let a=o.target?.closest?.("button,a,[role='button'],[role='link'],div,span");if(!a||!q(a))return;let d=P(a);d&&I(d)},!0),document.addEventListener("click",f,!0)},onRouteChange(){_(),h={query:null,results_count:0,search_latency_ms:null}},onConfigChange(){b()||_()}}}function Ue(){let e=null,i=[/doubleclick\.net/i,/googlesyndication\.com/i,/adservice\.google/i,/googleadservices\.com/i,/gampad\/ads/i,/adnxs\.com/i,/criteo/i,/pubmatic\.com/i,/openx\.net/i],t=null,c=null,u=null,s=null,l=0,g=new Set,h=new WeakSet,b=new WeakSet,C=new Map;function E(){return!!e?.state?.config?.plugins?.ads}function P(f){try{let r=f?.tagName?.toLowerCase()==="iframe"?f:f?.closest?.("iframe");if(!r)return!1;let o=r.getAttribute("src")||"";return o?i.some(a=>a.test(o)):!1}catch{return!1}}function q(f){let o=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return f?.closest?.(o)||f?.closest?.("[role='advertisement']")||(f?.tagName?.toLowerCase()==="iframe"?f:f?.closest?.("iframe"))||null}function R(f){try{if(!f)return!1;let o=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return!!(f.closest?.(o)||f.closest?.("[role='advertisement']")||P(f))}catch{return!1}}function m(f){let o=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]",a=q(f);if(!a)return null;let d=a.closest?.(o)||(a.matches?.(o)?a:null),y=a.tagName?.toLowerCase()==="iframe"?a:a.querySelector?.("iframe")||null,A=a.closest?.("[role='advertisement']")||(a.matches?.("[role='advertisement']")?a:null),w=e.getElementId(d||A||y||a);return w?{element_id:w,ad_id:d?.getAttribute?.("data-ad-id")||null,ad_slot:d?.getAttribute?.("data-ad-slot")||null,ad_provider:d?.getAttribute?.("data-ad-provider")||null}:null}function S(f){try{let r=f.getBoundingClientRect?.();return r?r.width>=40&&r.height>=40:!1}catch{return!1}}function _(f){try{if(!t||!f||h.has(f))return;h.add(f),t.observe(f)}catch{}}function v(){if(!E())return;let r=(e.state.config.ads||{}).containerSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe";try{document.querySelectorAll(r).forEach(o=>{if(!(g.size>900)&&R(o)){if(u&&!b.has(o))try{u.observe(o),b.add(o)}catch{}S(o)&&g.add(o)}})}catch{}}function k(){if(!E()||t)return;let f=e.state.config.ads||{},r=f.threshold??.5;t=new IntersectionObserver(o=>{for(let a of o){let d=a.target;if(!d||!R(d))continue;let y=m(d);if(!y?.element_id)continue;let A=a.intersectionRatio||0,w=a.isIntersecting&&A>=r;C.has(y.element_id)||C.set(y.element_id,{impTimer:null,impSent:!1,viewStart:null,viewableSent:!1,lastRatio:0});let p=C.get(y.element_id);if(p.lastRatio=A,w&&!p.impSent&&!p.impTimer&&(p.impTimer=setTimeout(()=>{p.impSent=!0,p.impTimer=null,e.enqueue(e.buildEvent("ad_impression",{_event_id:e.uuid(),element_id:y.element_id,ad_id:y.ad_id,ad_slot:y.ad_slot,ad_provider:y.ad_provider}))},f.minVisibleMs??300)),!w&&p.impTimer&&(clearTimeout(p.impTimer),p.impTimer=null),w)p.viewStart===null&&(p.viewStart=e.now());else if(p.viewStart!==null&&!p.viewableSent){let N=e.now()-p.viewStart;p.viewStart=null,N>=(f.minViewableMs??1e3)&&(p.viewableSent=!0,e.enqueue(e.buildEvent("ad_viewable",{_event_id:e.uuid(),element_id:y.element_id,ad_id:y.ad_id,ad_slot:y.ad_slot,ad_provider:y.ad_provider,view_time_ms:N,viewable_percent:Math.round(p.lastRatio*100)})))}C.set(y.element_id,p)}},{threshold:[r]});try{u=new ResizeObserver(o=>{for(let a of o){let d=a.target;!d||!R(d)||S(d)&&(g.add(d),_(d))}})}catch{u=null}v(),g.forEach(o=>_(o)),c=new MutationObserver(()=>{v(),g.forEach(o=>_(o))});try{c.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}l=0,s=setInterval(()=>{l++,v(),g.forEach(o=>_(o)),l>=(f.rescanTicks??15)&&(clearInterval(s),s=null)},f.rescanIntervalMs??2e3)}function x(){try{c?.disconnect()}catch{}c=null;try{t?.disconnect()}catch{}t=null;try{u?.disconnect()}catch{}u=null,s&&(clearInterval(s),s=null),g.clear(),C.clear()}function I(f){if(!E())return;let r=f.target,o=r?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt],iframe,[role='advertisement'],[data-ad-id],[data-ad-slot],[data-ad-provider]")||r;if(!o||!R(o))return;let a=m(o);a?.element_id&&e.enqueue(e.buildEvent("ad_click",{_event_id:e.uuid(),element_id:a.element_id,ad_id:a.ad_id,ad_slot:a.ad_slot,ad_provider:a.ad_provider}))}return{init(f){e=f,document.addEventListener("click",I,!0),E()&&k()},onConfigChange(){E()?k():x()},onRouteChange(){E()&&(x(),k())}}}function W(e,i){let t=L(),c=i||n.currentUrl||null;Y.clear(),n.previousUrl=c,n.currentUrl=t,Me(e,c,t),n.config.trackPageViews&&O(U("page_view",{trigger:e,_event_id:T()},{previous_url:c}))}function Oe(){let e=history.pushState,i=history.replaceState;history.pushState=function(...t){let c=n.currentUrl||L(),u=e.apply(this,t);return setTimeout(()=>W("pushState",c),0),u},history.replaceState=function(...t){let c=n.currentUrl||L(),u=i.apply(this,t);return setTimeout(()=>W("replaceState",c),0),u},window.addEventListener("popstate",()=>{let t=n.currentUrl||L();setTimeout(()=>W("popstate",t),0)}),window.addEventListener("hashchange",()=>{let t=n.currentUrl||L();setTimeout(()=>W("hashchange",t),0)})}function ue(e){if(!Array.isArray(e))return;let[i,t]=e;if(i==="__meta"){n.meta.project_id=t?.project_id||n.meta.project_id,n.meta.cdnBase=t?.cdnBase||n.meta.cdnBase,n.meta.tagVersion=t?.tagVersion||n.meta.tagVersion;return}if(i==="config"){if(!t)return;if(t.collectUrl&&(n.config.collectUrl=t.collectUrl),t.collect_url&&(n.config.collectUrl=t.collect_url),typeof t.debug=="boolean"&&(n.config.debug=t.debug),typeof t.trackPageViews=="boolean"&&(n.config.trackPageViews=t.trackPageViews),typeof t.trackClicks=="boolean"&&(n.config.trackClicks=t.trackClicks),typeof t.trackScroll=="boolean"&&(n.config.trackScroll=t.trackScroll),typeof t.trackErrors=="boolean"&&(n.config.trackErrors=t.trackErrors),typeof t.trackCards=="boolean"&&(n.config.trackCards=t.trackCards),typeof t.includeQueryHash=="boolean"&&(n.config.includeQueryHash=t.includeQueryHash),typeof t.sampleRate=="number"&&(n.config.sampleRate=Math.max(0,Math.min(1,t.sampleRate)),ce()),t.plugins&&typeof t.plugins=="object"){n.config.plugins=n.config.plugins||{};for(let c in t.plugins)typeof t.plugins[c]=="boolean"&&(n.config.plugins[c]=t.plugins[c])}t.search&&typeof t.search=="object"&&(n.config.search=n.config.search||{},Object.assign(n.config.search,t.search)),t.ads&&typeof t.ads=="object"&&(n.config.ads=n.config.ads||{},Object.assign(n.config.ads,t.ads)),t.cards&&typeof t.cards=="object"&&(n.config.cards=n.config.cards||{},Object.assign(n.config.cards,t.cards)),le();return}if(i==="consent"){t&&typeof t.analytics=="boolean"&&(n.config.consentAnalytics=t.analytics),le();return}if(i==="setUserId"){be(t);return}if(i==="event"){if(!t||typeof t!="object")return;let c=t.type||t.event_name||t.eventName;if(!c)return;let u=t.payload||t.properties||t.props||{},s=t.event_ts||t.eventTs;O(U(String(c),{_event_id:T(),...u||{}},{event_ts:typeof s=="number"&&Number.isFinite(s)?s:void 0}));return}i==="flush"&&H({reason:"manual"})}function qe(){n.entryReferrer=document.referrer||null,n.currentUrl=L(),n.previousUrl=null,ae(),ce();let e=window[X]=window[X]||[];e.forEach(ue);let i=e.push.bind(e);e.push=function(...t){return t.forEach(ue),i(...t)},Ae(),n.config.trackClicks&&document.addEventListener("click",ke,!0),n.config.trackScroll&&window.addEventListener("scroll",Ce,{passive:!0}),window.addEventListener("pagehide",()=>H({reason:"pagehide"})),Oe(),Ie(),$(Re()),$(Le()),$(Ue()),Te(),n.config.trackPageViews&&O(U("page_view",{trigger:"initial",_event_id:T()},{previous_url:null})),M("initialized",{project_id:n.meta.project_id,collectUrl:n.config.collectUrl,consent:n.config.consentAnalytics,sampledIn:n.sampledIn,includeQueryHash:n.config.includeQueryHash,plugins:n.config.plugins,trackCards:n.config.trackCards})}qe()})();})();
