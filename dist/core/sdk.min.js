(()=>{(()=>{let X="__pt_sdk_loaded__";if(window[X])return;window[X]=!0;let he="0.2.2",$="_ptq",Z="__pt_anonymous_id",z="__pt_user_id",G="__pt_session_id",J="__pt_session_last",pe=30*60*1e3,ee=200,_e=5e3,be=[25,50,75,100],te=80,r={meta:{project_id:null,cdnBase:null,tagVersion:null},config:{collectUrl:null,debug:!1,consentAnalytics:!0,trackPageViews:!0,trackClicks:!0,trackScroll:!0,trackErrors:!0,sampleRate:1,useBeaconOnUnload:!0,includeQueryHash:!1,plugins:{cards:!0,search:!1,ads:!1},cards:{threshold:.5,minVisibleMs:300,scopeSelector:"main",cardSelector:"article,[data-article-id],[data-content-id],[data-product-id],[data-item-id],[data-sku],.product,.product-card,.item,.card,[data-testid*='card']",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",minW:120,minH:80},search:{minEmitMs:350,maxWaitMs:4500,quietDebounceMs:220,recheckIntervalMs:300,firstFallbackMs:2200,scopeSelector:"main",resultItemSelector:"article,[data-article-id],[data-content-id],[data-result],.search-result,.result,[data-testid*='result'],.product,.product-card,.item,.card,[data-product-id],[data-sku],[data-item-id]",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",searchContextWindowMs:10*60*1e3},ads:{threshold:.5,minVisibleMs:300,minViewableMs:1e3,rescanIntervalMs:2e3,rescanTicks:15,containerSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",dataSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider]"}},sampleSeed:null,sampledIn:!0,userId:null,entryReferrer:null,currentUrl:null,previousUrl:null,webVitals:{}};function j(){return Date.now()}function O(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let o=Math.random()*16|0;return(e==="x"?o:o&3|8).toString(16)})}function B(e){return!e||typeof e!="string"||(e=e.replace(/\s+/g," ").trim(),!e)?null:(e.length>te&&(e=e.slice(0,te)+"\u2026"),e=e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[redacted_email]"),e=e.replace(/\+?\d[\d\s\-()]{7,}\d/g,"[redacted_phone]"),e)}function ne(e){try{return localStorage.getItem(e)}catch{return null}}function re(e,o){try{localStorage.setItem(e,o)}catch{}}function ye(e){try{localStorage.removeItem(e)}catch{}}function ie(e){try{return sessionStorage.getItem(e)}catch{return null}}function oe(e,o){try{sessionStorage.setItem(e,o)}catch{}}function ve(){let e=ne(Z);return e||(e=O(),re(Z,e)),e}function we(){try{let e=j(),o=Number(ie(J)||0),t=ie(G);return(!t||!o||e-o>pe)&&(t=O(),oe(G,t)),oe(J,String(e)),t}catch{return O()}}function ae(){if(r.userId)return r.userId;let e=ne(z);return r.userId=e?String(e):null,r.userId}function Se(e){if(e==null||e===""){r.userId=null,ye(z);return}r.userId=String(e),re(z,r.userId)}function se(){if(r.config.includeQueryHash)return window.location.href;let e=new URL(window.location.href);return e.search="",e.hash="",e.toString()}function Ee(){return{ua:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screen:{w:window.screen.width,h:window.screen.height,dpr:window.devicePixelRatio||1},viewport:{w:window.innerWidth,h:window.innerHeight},sdk_version:he,tag_version:r.meta.tagVersion||null}}function q(e,o={},t={}){let u=se(),d=t.previous_url!==void 0?t.previous_url:r.previousUrl||null,a=typeof t.event_ts=="number"?t.event_ts:j();return{project_id:r.meta.project_id,event_name:e,event_ts:a,anonymous_id:ve(),session_id:we(),user_id:ae(),page_url:u,page_path:window.location.pathname,page_title:document.title,referrer:r.entryReferrer||document.referrer||null,previous_url:d,context:Ee(),properties:o,web_vitals:r.webVitals||{}}}let N=[],F=null;function U(...e){r.config.debug&&console.log("[pt-sdk]",...e)}function ce(){return r.sampledIn&&r.config.consentAnalytics!==!1&&!!r.meta.project_id&&!!r.config.collectUrl}function P(e){if(ce()){if(r.config.debug)try{console.log("%cPT_EVT","font-weight:bold;color:#00b894",e.event_name,e)}catch{}N.push(e),N.length>=20?D({reason:"size"}):xe()}}function xe(){F||(F=setTimeout(()=>{F=null,D({reason:"timer"})},_e))}function ke(e,{useBeacon:o=!1}={}){if(window.__pt_debug_events=window.__pt_debug_events||[],window.__pt_debug_events.push(e),o&&navigator.sendBeacon)try{let t=new Blob([JSON.stringify(e)],{type:"application/json"}),u=navigator.sendBeacon(r.config.collectUrl,t);U("beacon sent:",u,e);return}catch(t){U("beacon failed, fallback to fetch",t)}fetch(r.config.collectUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).then(async t=>{if(t.ok)U("collect ok:",t.status,"events:",e.events?.length);else{let u=await t.text().catch(()=>"");U("collect non-2xx:",t.status,u)}}).catch(t=>U("collect failed:",t))}function D({reason:e}={}){if(!N.length||!ce())return;let o=N.splice(0,N.length),t=[];for(let d=0;d<o.length;d+=ee)t.push(o.slice(d,d+ee));let u=r.config.useBeaconOnUnload&&(e==="pagehide"||e==="hidden");t.forEach(d=>{let a={project_id:r.meta.project_id,sent_at:j(),events:d};ke(a,{useBeacon:u})})}function Ie(e){if(!e||!e.tagName)return null;let o=[],t=e;for(let u=0;u<4&&t&&t.tagName;u++){let d=t.tagName.toLowerCase();if(t.id){d+=`#${t.id}`,o.unshift(d);break}t.classList&&t.classList.length&&(d+="."+Array.from(t.classList).slice(0,2).join(".")),o.unshift(d),t=t.parentElement}return o.join(">")}function Q(e){let o=e?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e;if(!o)return null;let t=o.closest?.("[data-elt]")||o,u=t.getAttribute?.("data-elt")||t.getAttribute?.("data-testid")||t.getAttribute?.("aria-label")||Ie(t);return B(String(u||""))||u||null}function Ae(e){if(!r.config.trackClicks)return;let o=Q(e.target),t=e.target?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e.target;P(q("click",{_event_id:O(),element_id:o,element_type:t?.tagName?t.tagName.toLowerCase():null,element_role:t?.getAttribute?.("role")||t?.getAttribute?.("data-role")||null,x:e.clientX,y:e.clientY,button:e.button}))}let le=new Set;function Ce(){try{let e=r.config.scrollContainerSelector;if(e){let o=document.querySelector(e);if(o)return o}}catch{}return document.documentElement}function Me(){let e=Ce(),o=e.scrollTop||0,t=e.scrollHeight||0,u=e.clientHeight||1,d=Math.max(1,t-u),a=o/d*100;return Math.max(0,Math.min(100,a))}function ue(){if(!r.config.trackScroll)return;let e=Me(),o=Math.floor(e+.5);for(let t of be)o>=t&&!le.has(t)&&(le.add(t),P(q("scroll",{_event_id:O(),scroll_depth:t})))}function Te(){window.addEventListener("scroll",ue,{passive:!0});try{let e=r.config.scrollContainerSelector;if(e){let o=document.querySelector(e);o&&o.addEventListener("scroll",ue,{passive:!0})}}catch{}}function Re(){try{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart&&(r.webVitals.ttfb=Math.round(e.responseStart)),window.PerformanceObserver){new PerformanceObserver(c=>{c.getEntries().forEach(m=>{m.name==="first-contentful-paint"&&(r.webVitals.fcp=Math.round(m.startTime))})}).observe({type:"paint",buffered:!0}),new PerformanceObserver(c=>{let m=c.getEntries(),p=m[m.length-1];p&&(r.webVitals.lcp=Math.round(p.startTime))}).observe({type:"largest-contentful-paint",buffered:!0});let u=0;new PerformanceObserver(c=>{c.getEntries().forEach(m=>{m.hadRecentInput||(u+=m.value)}),r.webVitals.cls=Number(u.toFixed(4))}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(c=>{let m=c.getEntries()[0];m&&(r.webVitals.fid=Math.round(m.processingStart-m.startTime))}).observe({type:"first-input",buffered:!0}),Le()}}catch{}}function Le(){try{let c=function(x,T){if(!x.length)return 0;let b=x.slice().sort((L,k)=>L-k),E=Math.min(b.length-1,Math.max(0,Math.ceil(T*b.length)-1));return b[E]||0},p=function(){m||(m=setTimeout(()=>{m=null;let x=c(t,.98),T=c(t,.95);r.webVitals.inp=x||0,r.webVitals.inp_p95=T||0,r.webVitals.inp_worst=a||0},400))},_=function(){let x=Date.now();for(let[T,b]of o.entries())x-b.lastSeen>=d&&(t.push(b.maxDur),t.length>u&&t.splice(0,t.length-u),o.delete(T),p())};if(!window.PerformanceObserver||r.__inpObserverStarted)return;r.__inpObserverStarted=!0;let e=new Set(["pointermove","mousemove","scroll","wheel","touchmove"]),o=new Map,t=[],u=2e3,d=2e3,a=0,m=null,S=setInterval(_,1e3);r.__inpCleanupInterval=S;let M=new PerformanceObserver(x=>{let T=Date.now();for(let b of x.getEntries()){if(!b||!b.interactionId||e.has(b.name))continue;let E=Math.round(b.duration||0);if(E<=0)continue;let L=b.interactionId,k=o.get(L);k?(E>k.maxDur&&(k.maxDur=E),k.lastSeen=T,o.set(L,k)):o.set(L,{maxDur:E,lastSeen:T}),E>a&&(a=E)}_()});try{M.observe({type:"event",buffered:!0,durationThreshold:40})}catch{M.observe({type:"event",buffered:!0})}}catch{}}function de(){(r.sampleSeed===null||r.sampleSeed===void 0)&&(r.sampleSeed=Math.random());let e=typeof r.config.sampleRate=="number"?r.config.sampleRate:1,o=Math.max(0,Math.min(1,e));r.sampledIn=r.sampleSeed<o}function Oe(){if(!r.config.trackErrors)return;let e=new Set,o=a=>{try{let c=JSON.stringify(a);return c.length>800?c.slice(0,800):c}catch{return String(a)}},t=a=>{try{if(a==null)return null;let c=String(a).trim();return c?(c.length>500&&(c=c.slice(0,500)+"\u2026"),c):null}catch{return null}},u=(a,c)=>{try{let m=a||c?.fileName||c?.sourceURL||c?.scriptURL||null;if(m)return m;let p=String(c?.stack||"");if(!p)return null;let _=p.match(/(https?:\/\/[^\s)]+|file:\/\/[^\s)]+)/i);if(_&&_[1])return _[1];let S=p.match(/(\b\/[^\s)]+):\d+:\d+/);return S&&S[1]?S[1]:null}catch{return null}},d=a=>{let c=o(a);e.has(c)||(e.add(c),P(q("error",{_event_id:O(),...a})))};window.addEventListener("error",a=>{try{if(!a.message&&(a.target||a.srcElement)){let _=a.target||a.srcElement,S=_?.currentSrc||_?.src||_?.href||_?.getAttribute?.("src")||_?.getAttribute?.("href")||null,M=t(S);d({error_type:"resource",message:"resource_load_error",source_url:M,resource_url:M,resource_tag:(_?.tagName||"").toLowerCase()||null,element_id:Q(_)||null,is_fatal:!1});return}let m=B(a?.message)||"js_error",p=t(u(a?.filename,a?.error))||t(a?.filename)||null;d({error_type:"js",message:m,filename:a?.filename||null,lineno:a?.lineno||null,colno:a?.colno||null,source_url:p,is_fatal:!1})}catch{d({error_type:"js",message:"js_error",source_url:null,is_fatal:!1})}},!0),window.addEventListener("unhandledrejection",a=>{try{let c=a?.reason?.message||String(a?.reason||""),m=B(c)||"unhandled_promise",p=t(u(null,a?.reason))||null;d({error_type:"unhandledrejection",message:m,source_url:p,is_fatal:!1})}catch{d({error_type:"unhandledrejection",message:"unhandled_promise",source_url:null,is_fatal:!1})}})}let K=[];function Y(e){e&&typeof e.init=="function"&&K.push(e)}function Ue(){let e={state:r,enqueue:P,buildEvent:q,uuid:O,sanitizeText:B,getElementId:Q,dbg:U,now:j};K.forEach(o=>{try{o.init(e)}catch(t){U("plugin init failed",t)}})}function fe(){K.forEach(e=>{try{e.onConfigChange?.(r.config)}catch(o){U("plugin onConfigChange failed",o)}})}function qe(){let e=null,o=null,t=null,u=null,d=null,a=0,c=new Set,m=new WeakSet,p=new WeakSet,_=new WeakMap;function S(){return e?.state?.config?.plugins?.cards!==!1}function M(g){try{if(!g||g.hidden)return!1;let v=window.getComputedStyle?getComputedStyle(g):null;if(v&&(v.display==="none"||v.visibility==="hidden"||v.opacity==="0")||g.getClientRects&&g.getClientRects().length===0)return!1;let w=g.getBoundingClientRect?.();return w?w.width>0&&w.height>0:!1}catch{return!0}}function x(g,v,w){try{let I=g.getBoundingClientRect?.();return I?I.width>=v&&I.height>=w:!1}catch{return!1}}function T(g,v){try{return v?!!(g?.matches?.(v)||g?.closest?.(v)):!1}catch{return!1}}function b(){if(!S())return;let g=e.state.config.cards||{},v=document.querySelector(g.scopeSelector||"main")||document.body||document.documentElement,w=g.cardSelector||"article",I=g.adExcludeSelector||null,s=g.minW??120,y=g.minH??80;try{v.querySelectorAll(w).forEach(n=>{if(!(c.size>1e3)&&M(n)&&x(n,s,y)&&!T(n,I)&&(c.add(n),u&&!p.has(n)))try{u.observe(n),p.add(n)}catch{}})}catch{}}function E(g){try{if(!o||!g||m.has(g))return;m.add(g),o.observe(g)}catch{}}function L(){if(!S()||o)return;let g=e.state.config.cards||{},v=g.threshold??.5;o=new IntersectionObserver(w=>{for(let I of w){let s=I.target;if(!s)continue;let y=g.adExcludeSelector||null;if(T(s,y))continue;let n=I.isIntersecting&&(I.intersectionRatio||0)>=v,i=_.get(s);i||(i={timer:null,sent:!1,impression_id:null,lastRatio:0},_.set(s,i)),i.lastRatio=I.intersectionRatio||0,n&&!i.sent&&!i.timer&&(i.impression_id=i.impression_id||e.uuid(),i.timer=setTimeout(()=>{i.sent=!0,i.timer=null,e.enqueue(e.buildEvent("card_impression",{_event_id:e.uuid(),element_id:e.getElementId(s),impression_id:i.impression_id,viewport_percent:Math.round((i.lastRatio||0)*100)}))},g.minVisibleMs??300)),!n&&i.timer&&(clearTimeout(i.timer),i.timer=null),_.set(s,i)}},{threshold:[v]});try{u=new ResizeObserver(w=>{for(let I of w){let s=I.target;s&&(c.add(s),E(s))}})}catch{u=null}b(),c.forEach(w=>E(w)),t=new MutationObserver(()=>{b(),c.forEach(w=>E(w))});try{t.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}a=0,d=setInterval(()=>{a++,b(),c.forEach(w=>E(w)),a>=10&&(clearInterval(d),d=null)},1500)}function k(){try{t&&t.disconnect()}catch{}t=null;try{o&&o.disconnect()}catch{}o=null;try{u&&u.disconnect()}catch{}u=null,d&&(clearInterval(d),d=null),c.clear()}return{init(g){e=g,S()&&L()},onConfigChange(){S()?L():k()}}}function Pe(){let e=null,o=null,t=null,u=null,d=null,a=null,c=null,m=null,p={query:null,results_count:0,search_latency_ms:null,ts:0};function _(){return!!e?.state?.config?.plugins?.search}function S(){try{if(/search/i.test(location.pathname)||/search/i.test(location.href))return!0;let n=location.search||"";return/[?&](q|query|search)=/i.test(n)}catch{return!1}}function M(){if(S())return!0;let n=e?.state?.config?.search?.searchContextWindowMs??10*60*1e3;return!p?.query||!p?.ts?!1:e.now()-p.ts<=n}function x(n){let i=(n?.tagName||"").toLowerCase();if(i!=="input"&&i!=="textarea")return!1;let l=(n.getAttribute?.("type")||"").toLowerCase(),f=n.getAttribute?.("role")||"",R=n.getAttribute?.("name")||"",A=n.getAttribute?.("placeholder")||"";return f==="searchbox"||l==="search"||/search/i.test(R)||/search/i.test(A)}function T(n){try{let i=n?.closest?.("form")||null;if(i){let l=Array.from(i.querySelectorAll("input,textarea")).find(x);if(l)return l}return Array.from(document.querySelectorAll("input,textarea")).find(x)||null}catch{return null}}function b(n){try{if(!n)return!1;let i=(n.tagName||"").toLowerCase();if(!["button","a","div","span"].includes(i))return!1;let l=(n.getAttribute?.("type")||"").toLowerCase();if(i==="button"&&l==="submit"){let V=n.closest?.("form");if(V&&Array.from(V.querySelectorAll("input,textarea")).find(x))return!0}let f=(n.getAttribute?.("role")||"").toLowerCase(),R=(n.getAttribute?.("aria-label")||"").toLowerCase(),A=(n.getAttribute?.("title")||"").toLowerCase(),h=(n.getAttribute?.("data-elt")||n.getAttribute?.("data-testid")||"").toLowerCase(),C=(n.innerText||"").toLowerCase(),W=`${R} ${A} ${h} ${C}`.trim();return i==="button"&&(l==="submit"||l==="button")?/search|find|go/.test(W):f==="button"||f==="link"?/search|find|go/.test(W):i==="a"?/search|find|go/.test(W):!1}catch{return!1}}function E(n){try{if(!n||n.hidden)return!1;let i=window.getComputedStyle?getComputedStyle(n):null;if(i&&(i.display==="none"||i.visibility==="hidden"||i.opacity==="0")||n.getClientRects&&n.getClientRects().length===0)return!1;let l=n.getBoundingClientRect?.();return l?l.width>0&&l.height>0:!1}catch{return!0}}function L(){try{let n=e.state.config.search||{},i=document.querySelector(n.scopeSelector||"main")||document.body||document.documentElement,l=n.resultItemSelector||"article,[data-article-id],[data-content-id]",f=n.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",R=Array.from(i.querySelectorAll(l)),A=0;for(let h of R){if(!E(h)||h.closest?.("header,nav,footer")||f&&(h.matches?.(f)||h.closest?.(f)))continue;let C=h.getBoundingClientRect?.();C&&(C.width<80||C.height<40)||A++}return A}catch{return 0}}function k(){if(a){try{a.disconnect()}catch{}a=null}c&&(clearTimeout(c),c=null),m&&(clearTimeout(m),m=null)}function g(){o=null,t=null,u=null,d=null,k()}function v(n=!1){if(!o||!t)return!1;let i=e.state.config.search||{},l=Math.max(0,e.now()-t),f=L();return n||f>0&&l>=(i.minEmitMs??350)||l>=(i.maxWaitMs??4500)?(p={query:d||"",results_count:f,search_latency_ms:Math.round(l),ts:e.now()},e.enqueue(e.buildEvent("search",{_event_id:e.uuid(),element_id:u||"search_input",query:p.query,results_count:p.results_count,search_latency_ms:p.search_latency_ms})),g(),!0):!1}function w(){if(a)return;let n=e.state.config.search||{},i=document.querySelector(n.scopeSelector||"main")||document.body||document.documentElement;a=new MutationObserver(()=>{o&&(c&&clearTimeout(c),c=setTimeout(()=>{v(!1)},n.quietDebounceMs??220))});try{a.observe(i,{childList:!0,subtree:!0,attributes:!0})}catch{}}function I(){let n=e.state.config.search||{};if(!o||!t)return;let i=Math.max(0,e.now()-t),l=n.maxWaitMs??4500;if(!v(!1)){if(i>=l){v(!0);return}m=setTimeout(I,n.recheckIntervalMs??300)}}function s(n){if(!_())return;let i=e.sanitizeText(n?.value)||"";if(!i)return;o=e.uuid(),t=e.now(),u=e.getElementId(n)||"search_input",d=i,k(),w();let l=e.state.config.search||{};m=setTimeout(I,l.firstFallbackMs??2200)}function y(n){if(!_()||!M()||!p||(p.results_count||0)<=0)return;let i=e.state.config.search||{},l=document.querySelector(i.scopeSelector||"main")||document.body||document.documentElement,f=i.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",R=i.resultItemSelector||"article,[data-article-id],[data-content-id]",A=n.target,h=A?.closest?.("a,button,[role='link'],[role='button']")||A;if(!h||f&&(h.matches?.(f)||h.closest?.(f)))return;let C=h.closest?.(R);if(!C||f&&(C.matches?.(f)||C.closest?.(f)))return;let V=Array.from(l.querySelectorAll(R)).filter(H=>H&&E(H)&&!(f&&(H.matches?.(f)||H.closest?.(f)))).indexOf(C),ge=V>=0?V+1:null,je=C.getAttribute?.("data-article-id")||C.getAttribute?.("data-content-id")||C.getAttribute?.("data-result-id")||h.getAttribute?.("href")||null;e.enqueue(e.buildEvent("search_result_click",{_event_id:e.uuid(),element_id:e.getElementId(h),query:p.query,clicked_result_id:je,result_rank:ge,results_count:p.results_count}))}return{init(n){e=n,document.addEventListener("keydown",i=>{if(!_())return;let l=i.target;x(l)&&i.key==="Enter"&&s(l)},!0),document.addEventListener("submit",i=>{if(!_())return;let l=i.target;if(!l||l.nodeType!==1)return;let f=Array.from(l.querySelectorAll("input,textarea")).find(x);f&&s(f)},!0),document.addEventListener("click",i=>{if(!_())return;let l=i.target?.closest?.("button,a,[role='button'],[role='link'],div,span");if(!l||!b(l))return;let f=T(l);f&&s(f)},!0),document.addEventListener("click",y,!0)},onConfigChange(){_()||g()}}}function Ne(){let e=null,o=[/doubleclick\.net/i,/googlesyndication\.com/i,/adservice\.google/i,/googleadservices\.com/i,/gampad\/ads/i,/adnxs\.com/i,/criteo/i,/pubmatic\.com/i,/openx\.net/i],t=null,u=null,d=null,a=null,c=0,m=new Set,p=new WeakSet,_=new WeakSet,S=new Map;function M(){return!!e?.state?.config?.plugins?.ads}function x(s){try{let y=s?.tagName?.toLowerCase()==="iframe"?s:s?.closest?.("iframe");if(!y)return!1;let n=y.getAttribute("src")||"";return n?o.some(i=>i.test(n)):!1}catch{return!1}}function T(s){let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return s?.closest?.(n)||s?.closest?.("[role='advertisement']")||(s?.tagName?.toLowerCase()==="iframe"?s:s?.closest?.("iframe"))||null}function b(s){try{if(!s)return!1;let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return!!(s.closest?.(n)||s.closest?.("[role='advertisement']")||x(s))}catch{return!1}}function E(s){let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]",i=T(s);if(!i)return null;let l=i.closest?.(n)||(i.matches?.(n)?i:null),f=i.tagName?.toLowerCase()==="iframe"?i:i.querySelector?.("iframe")||null,R=i.closest?.("[role='advertisement']")||(i.matches?.("[role='advertisement']")?i:null),A=e.getElementId(l||R||f||i);return A?{element_id:A,ad_id:l?.getAttribute?.("data-ad-id")||null,ad_slot:l?.getAttribute?.("data-ad-slot")||null,ad_provider:l?.getAttribute?.("data-ad-provider")||null}:null}function L(s){try{let y=s.getBoundingClientRect?.();return y?y.width>=40&&y.height>=40:!1}catch{return!1}}function k(s){try{if(!t||!s||p.has(s))return;p.add(s),t.observe(s)}catch{}}function g(){if(!M())return;let y=(e.state.config.ads||{}).containerSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe";try{document.querySelectorAll(y).forEach(n=>{if(!(m.size>900)&&b(n)){if(d&&!_.has(n))try{d.observe(n),_.add(n)}catch{}L(n)&&m.add(n)}})}catch{}}function v(){if(!M()||t)return;let s=e.state.config.ads||{},y=s.threshold??.5;t=new IntersectionObserver(n=>{for(let i of n){let l=i.target;if(!l||!b(l))continue;let f=E(l);if(!f?.element_id)continue;let R=i.intersectionRatio||0,A=i.isIntersecting&&R>=y;S.has(f.element_id)||S.set(f.element_id,{impTimer:null,impSent:!1,viewStart:null,viewableSent:!1,lastRatio:0});let h=S.get(f.element_id);if(h.lastRatio=R,A&&!h.impSent&&!h.impTimer&&(h.impTimer=setTimeout(()=>{h.impSent=!0,h.impTimer=null,e.enqueue(e.buildEvent("ad_impression",{_event_id:e.uuid(),element_id:f.element_id,ad_id:f.ad_id,ad_slot:f.ad_slot,ad_provider:f.ad_provider}))},s.minVisibleMs??300)),!A&&h.impTimer&&(clearTimeout(h.impTimer),h.impTimer=null),A)h.viewStart===null&&(h.viewStart=e.now());else if(h.viewStart!==null&&!h.viewableSent){let C=e.now()-h.viewStart;h.viewStart=null,C>=(s.minViewableMs??1e3)&&(h.viewableSent=!0,e.enqueue(e.buildEvent("ad_viewable",{_event_id:e.uuid(),element_id:f.element_id,ad_id:f.ad_id,ad_slot:f.ad_slot,ad_provider:f.ad_provider,view_time_ms:C,viewable_percent:Math.round(h.lastRatio*100)})))}S.set(f.element_id,h)}},{threshold:[y]});try{d=new ResizeObserver(n=>{for(let i of n){let l=i.target;!l||!b(l)||L(l)&&(m.add(l),k(l))}})}catch{d=null}g(),m.forEach(n=>k(n)),u=new MutationObserver(()=>{g(),m.forEach(n=>k(n))});try{u.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}c=0,a=setInterval(()=>{c++,g(),m.forEach(n=>k(n)),c>=(s.rescanTicks??15)&&(clearInterval(a),a=null)},s.rescanIntervalMs??2e3)}function w(){try{u&&u.disconnect()}catch{}u=null;try{t&&t.disconnect()}catch{}t=null;try{d&&d.disconnect()}catch{}d=null,a&&(clearInterval(a),a=null),m.clear(),S.clear()}function I(s){if(!M())return;let y=s.target,n=y?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt],iframe,[role='advertisement'],[data-ad-id],[data-ad-slot],[data-ad-provider]")||y;if(!n||!b(n))return;let i=E(n);i?.element_id&&e.enqueue(e.buildEvent("ad_click",{_event_id:e.uuid(),element_id:i.element_id,ad_id:i.ad_id,ad_slot:i.ad_slot,ad_provider:i.ad_provider}))}return{init(s){e=s,document.addEventListener("click",I,!0),M()&&v()},onConfigChange(){M()?v():w()}}}function me(e){if(!Array.isArray(e))return;let[o,t]=e;if(o==="__meta"){r.meta.project_id=t?.project_id||r.meta.project_id,r.meta.cdnBase=t?.cdnBase||r.meta.cdnBase,r.meta.tagVersion=t?.tagVersion||r.meta.tagVersion;return}if(o==="config"){if(!t)return;if(t.collectUrl&&(r.config.collectUrl=t.collectUrl),typeof t.debug=="boolean"&&(r.config.debug=t.debug),typeof t.trackPageViews=="boolean"&&(r.config.trackPageViews=t.trackPageViews),typeof t.trackClicks=="boolean"&&(r.config.trackClicks=t.trackClicks),typeof t.trackScroll=="boolean"&&(r.config.trackScroll=t.trackScroll),typeof t.trackErrors=="boolean"&&(r.config.trackErrors=t.trackErrors),typeof t.includeQueryHash=="boolean"&&(r.config.includeQueryHash=t.includeQueryHash),typeof t.sampleRate=="number"&&(r.config.sampleRate=Math.max(0,Math.min(1,t.sampleRate)),de()),t.plugins&&typeof t.plugins=="object"){r.config.plugins=r.config.plugins||{};for(let u in t.plugins)typeof t.plugins[u]=="boolean"&&(r.config.plugins[u]=t.plugins[u])}t.cards&&typeof t.cards=="object"&&(r.config.cards=r.config.cards||{},Object.assign(r.config.cards,t.cards)),t.search&&typeof t.search=="object"&&(r.config.search=r.config.search||{},Object.assign(r.config.search,t.search)),t.ads&&typeof t.ads=="object"&&(r.config.ads=r.config.ads||{},Object.assign(r.config.ads,t.ads)),fe();return}if(o==="consent"){t&&typeof t.analytics=="boolean"&&(r.config.consentAnalytics=t.analytics),fe();return}if(o==="setUserId"){Se(t);return}if(o==="event"){if(!t)return;let u=t.type||t.event_name;if(!u)return;let d=t.payload||t.properties||{},a=typeof t.event_ts=="number"?t.event_ts:void 0;P(q(u,{_event_id:O(),...d},{event_ts:a}));return}o==="flush"&&D({reason:"manual"})}function Ve(){r.entryReferrer=document.referrer||null,r.currentUrl=se(),r.previousUrl=null,ae(),de();let e=window[$]=window[$]||[];e.forEach(me);let o=e.push.bind(e);e.push=function(...t){return t.forEach(me),o(...t)},Re(),r.config.trackClicks&&document.addEventListener("click",Ae,!0),r.config.trackScroll&&Te(),window.addEventListener("pagehide",()=>D({reason:"pagehide"})),Oe(),Y(qe()),Y(Pe()),Y(Ne()),Ue(),r.config.trackPageViews&&P(q("page_view",{trigger:"initial",_event_id:O()},{previous_url:null})),U("initialized",{project_id:r.meta.project_id,collectUrl:r.config.collectUrl,consent:r.config.consentAnalytics,sampledIn:r.sampledIn,includeQueryHash:r.config.includeQueryHash,plugins:r.config.plugins})}Ve()})();})();
