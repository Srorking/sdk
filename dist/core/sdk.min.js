(()=>{(()=>{let $="__pt_sdk_loaded__";if(window[$])return;window[$]=!0;let he="0.2.2",X="_ptq",Z="__pt_anonymous_id",D="__pt_user_id",G="__pt_session_id",J="__pt_session_last",pe=30*60*1e3,ee=200,_e=5e3,ye=[25,50,75,100],te=80,i={meta:{project_id:null,cdnBase:null,tagVersion:null},config:{collectUrl:null,debug:!1,consentAnalytics:!0,trackPageViews:!0,trackClicks:!0,trackScroll:!0,trackErrors:!0,sampleRate:1,useBeaconOnUnload:!0,includeQueryHash:!1,plugins:{cards:!0,search:!1,ads:!1},cards:{threshold:.5,minVisibleMs:300,scopeSelector:"main",cardSelector:"article,[data-article-id],[data-content-id],[data-product-id],[data-item-id],[data-sku],.product,.product-card,.item,.card,[data-testid*='card']",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",minW:120,minH:80},search:{minEmitMs:350,maxWaitMs:4500,quietDebounceMs:220,recheckIntervalMs:300,firstFallbackMs:2200,scopeSelector:"main",resultItemSelector:"article,[data-article-id],[data-content-id],[data-result],.search-result,.result,[data-testid*='result'],.product,.product-card,.item,.card,[data-product-id],[data-sku],[data-item-id]",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",searchContextWindowMs:10*60*1e3},ads:{threshold:.5,minVisibleMs:300,minViewableMs:1e3,rescanIntervalMs:2e3,rescanTicks:15,containerSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",dataSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider]"}},sampleSeed:null,sampledIn:!0,userId:null,entryReferrer:null,currentUrl:null,previousUrl:null,webVitals:{}};function j(){return Date.now()}function M(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let o=Math.random()*16|0;return(e==="x"?o:o&3|8).toString(16)})}function B(e){return!e||typeof e!="string"||(e=e.replace(/\s+/g," ").trim(),!e)?null:(e.length>te&&(e=e.slice(0,te)+"\u2026"),e=e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[redacted_email]"),e=e.replace(/\+?\d[\d\s\-()]{7,}\d/g,"[redacted_phone]"),e)}function ne(e){try{return localStorage.getItem(e)}catch{return null}}function re(e,o){try{localStorage.setItem(e,o)}catch{}}function be(e){try{localStorage.removeItem(e)}catch{}}function ie(e){try{return sessionStorage.getItem(e)}catch{return null}}function oe(e,o){try{sessionStorage.setItem(e,o)}catch{}}function ve(){let e=ne(Z);return e||(e=M(),re(Z,e)),e}function Se(){try{let e=j(),o=Number(ie(J)||0),t=ie(G);return(!t||!o||e-o>pe)&&(t=M(),oe(G,t)),oe(J,String(e)),t}catch{return M()}}function ae(){if(i.userId)return i.userId;let e=ne(D);return i.userId=e?String(e):null,i.userId}function we(e){if(e==null||e===""){i.userId=null,be(D);return}i.userId=String(e),re(D,i.userId)}function se(){if(i.config.includeQueryHash)return window.location.href;let e=new URL(window.location.href);return e.search="",e.hash="",e.toString()}function Ee(){return{ua:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screen:{w:window.screen.width,h:window.screen.height,dpr:window.devicePixelRatio||1},viewport:{w:window.innerWidth,h:window.innerHeight},sdk_version:he,tag_version:i.meta.tagVersion||null}}function q(e,o={},t={}){let u=se(),d=t.previous_url!==void 0?t.previous_url:i.previousUrl||null,a=typeof t.event_ts=="number"?t.event_ts:j();return{project_id:i.meta.project_id,event_name:e,event_ts:a,anonymous_id:ve(),session_id:Se(),user_id:ae(),page_url:u,page_path:window.location.pathname,page_title:document.title,referrer:i.entryReferrer||document.referrer||null,previous_url:d,context:Ee(),properties:o,web_vitals:i.webVitals||{}}}let N=[],F=null;function R(...e){i.config.debug&&console.log("[pt-sdk]",...e)}function ce(){return i.sampledIn&&i.config.consentAnalytics!==!1&&!!i.meta.project_id&&!!i.config.collectUrl}function O(e){if(ce()){if(i.config.debug)try{console.log("%cPT_EVT","font-weight:bold;color:#00b894",e.event_name,e)}catch{}N.push(e),N.length>=20?W({reason:"size"}):ke()}}function ke(){F||(F=setTimeout(()=>{F=null,W({reason:"timer"})},_e))}function xe(e,{useBeacon:o=!1}={}){if(window.__pt_debug_events=window.__pt_debug_events||[],window.__pt_debug_events.push(e),o&&navigator.sendBeacon)try{let t=new Blob([JSON.stringify(e)],{type:"application/json"}),u=navigator.sendBeacon(i.config.collectUrl,t);R("beacon sent:",u,e);return}catch(t){R("beacon failed, fallback to fetch",t)}fetch(i.config.collectUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).then(async t=>{if(t.ok)R("collect ok:",t.status,"events:",e.events?.length);else{let u=await t.text().catch(()=>"");R("collect non-2xx:",t.status,u)}}).catch(t=>R("collect failed:",t))}function W({reason:e}={}){if(!N.length||!ce())return;let o=N.splice(0,N.length),t=[];for(let d=0;d<o.length;d+=ee)t.push(o.slice(d,d+ee));let u=i.config.useBeaconOnUnload&&(e==="pagehide"||e==="hidden");t.forEach(d=>{let a={project_id:i.meta.project_id,sent_at:j(),events:d};xe(a,{useBeacon:u})})}function Ce(e){if(!e||!e.tagName)return null;let o=[],t=e;for(let u=0;u<4&&t&&t.tagName;u++){let d=t.tagName.toLowerCase();if(t.id){d+=`#${t.id}`,o.unshift(d);break}t.classList&&t.classList.length&&(d+="."+Array.from(t.classList).slice(0,2).join(".")),o.unshift(d),t=t.parentElement}return o.join(">")}function Q(e){let o=e?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e;if(!o)return null;let t=o.closest?.("[data-elt]")||o,u=t.getAttribute?.("data-elt")||t.getAttribute?.("data-testid")||t.getAttribute?.("aria-label")||Ce(t);return B(String(u||""))||u||null}function Ae(e){if(!i.config.trackClicks)return;let o=Q(e.target),t=e.target?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e.target;O(q("click",{_event_id:M(),element_id:o,element_type:t?.tagName?t.tagName.toLowerCase():null,element_role:t?.getAttribute?.("role")||t?.getAttribute?.("data-role")||null,x:e.clientX,y:e.clientY,button:e.button}))}let le=new Set;function Ie(){try{let e=i.config.scrollContainerSelector;if(e){let o=document.querySelector(e);if(o)return o}}catch{}return document.documentElement}function Me(){let e=Ie(),o=e.scrollTop||0,t=e.scrollHeight||0,u=e.clientHeight||1,d=Math.max(1,t-u),a=o/d*100;return Math.max(0,Math.min(100,a))}function ue(){if(!i.config.trackScroll)return;let e=Me(),o=Math.floor(e+.5);for(let t of ye)o>=t&&!le.has(t)&&(le.add(t),O(q("scroll",{_event_id:M(),scroll_depth:t})))}function Re(){window.addEventListener("scroll",ue,{passive:!0});try{let e=i.config.scrollContainerSelector;if(e){let o=document.querySelector(e);o&&o.addEventListener("scroll",ue,{passive:!0})}}catch{}}function Le(){try{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart&&(i.webVitals.ttfb=Math.round(e.responseStart)),window.PerformanceObserver){new PerformanceObserver(l=>{l.getEntries().forEach(m=>{m.name==="first-contentful-paint"&&(i.webVitals.fcp=Math.round(m.startTime))})}).observe({type:"paint",buffered:!0}),new PerformanceObserver(l=>{let m=l.getEntries(),p=m[m.length-1];p&&(i.webVitals.lcp=Math.round(p.startTime))}).observe({type:"largest-contentful-paint",buffered:!0});let u=0;new PerformanceObserver(l=>{l.getEntries().forEach(m=>{m.hadRecentInput||(u+=m.value)}),i.webVitals.cls=Number(u.toFixed(4))}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(l=>{let m=l.getEntries()[0];m&&(i.webVitals.fid=Math.round(m.processingStart-m.startTime))}).observe({type:"first-input",buffered:!0})}}catch{}}function de(){(i.sampleSeed===null||i.sampleSeed===void 0)&&(i.sampleSeed=Math.random());let e=typeof i.config.sampleRate=="number"?i.config.sampleRate:1,o=Math.max(0,Math.min(1,e));i.sampledIn=i.sampleSeed<o}function Te(){if(!i.config.trackErrors)return;let e=new Set,o=a=>{try{let l=JSON.stringify(a);return l.length>800?l.slice(0,800):l}catch{return String(a)}},t=a=>{try{if(a==null)return null;let l=String(a).trim();return l?(l.length>500&&(l=l.slice(0,500)+"\u2026"),l):null}catch{return null}},u=(a,l)=>{try{let m=a||l?.fileName||l?.sourceURL||l?.scriptURL||null;if(m)return m;let p=String(l?.stack||"");if(!p)return null;let _=p.match(/(https?:\/\/[^\s)]+|file:\/\/[^\s)]+)/i);if(_&&_[1])return _[1];let S=p.match(/(\b\/[^\s)]+):\d+:\d+/);return S&&S[1]?S[1]:null}catch{return null}},d=a=>{let l=o(a);e.has(l)||(e.add(l),O(q("error",{_event_id:M(),...a})))};window.addEventListener("error",a=>{try{if(!a.message&&(a.target||a.srcElement)){let _=a.target||a.srcElement,S=_?.currentSrc||_?.src||_?.href||_?.getAttribute?.("src")||_?.getAttribute?.("href")||null,C=t(S);d({error_type:"resource",message:"resource_load_error",source_url:C,resource_url:C,resource_tag:(_?.tagName||"").toLowerCase()||null,element_id:Q(_)||null,is_fatal:!1});return}let m=B(a?.message)||"js_error",p=t(u(a?.filename,a?.error))||t(a?.filename)||null;d({error_type:"js",message:m,filename:a?.filename||null,lineno:a?.lineno||null,colno:a?.colno||null,source_url:p,is_fatal:!1})}catch{d({error_type:"js",message:"js_error",source_url:null,is_fatal:!1})}},!0),window.addEventListener("unhandledrejection",a=>{try{let l=a?.reason?.message||String(a?.reason||""),m=B(l)||"unhandled_promise",p=t(u(null,a?.reason))||null;d({error_type:"unhandledrejection",message:m,source_url:p,is_fatal:!1})}catch{d({error_type:"unhandledrejection",message:"unhandled_promise",source_url:null,is_fatal:!1})}})}let K=[];function Y(e){e&&typeof e.init=="function"&&K.push(e)}function Ue(){let e={state:i,enqueue:O,buildEvent:q,uuid:M,sanitizeText:B,getElementId:Q,dbg:R,now:j};K.forEach(o=>{try{o.init(e)}catch(t){R("plugin init failed",t)}})}function fe(){K.forEach(e=>{try{e.onConfigChange?.(i.config)}catch(o){R("plugin onConfigChange failed",o)}})}function qe(){let e=null,o=null,t=null,u=null,d=null,a=0,l=new Set,m=new WeakSet,p=new WeakSet,_=new WeakMap;function S(){return e?.state?.config?.plugins?.cards!==!1}function C(g){try{if(!g||g.hidden)return!1;let b=window.getComputedStyle?getComputedStyle(g):null;if(b&&(b.display==="none"||b.visibility==="hidden"||b.opacity==="0")||g.getClientRects&&g.getClientRects().length===0)return!1;let v=g.getBoundingClientRect?.();return v?v.width>0&&v.height>0:!1}catch{return!0}}function L(g,b,v){try{let w=g.getBoundingClientRect?.();return w?w.width>=b&&w.height>=v:!1}catch{return!1}}function P(g,b){try{return b?!!(g?.matches?.(b)||g?.closest?.(b)):!1}catch{return!1}}function A(){if(!S())return;let g=e.state.config.cards||{},b=document.querySelector(g.scopeSelector||"main")||document.body||document.documentElement,v=g.cardSelector||"article",w=g.adExcludeSelector||null,s=g.minW??120,y=g.minH??80;try{b.querySelectorAll(v).forEach(n=>{if(!(l.size>1e3)&&C(n)&&L(n,s,y)&&!P(n,w)&&(l.add(n),u&&!p.has(n)))try{u.observe(n),p.add(n)}catch{}})}catch{}}function I(g){try{if(!o||!g||m.has(g))return;m.add(g),o.observe(g)}catch{}}function U(){if(!S()||o)return;let g=e.state.config.cards||{},b=g.threshold??.5;o=new IntersectionObserver(v=>{for(let w of v){let s=w.target;if(!s)continue;let y=g.adExcludeSelector||null;if(P(s,y))continue;let n=w.isIntersecting&&(w.intersectionRatio||0)>=b,r=_.get(s);r||(r={timer:null,sent:!1,impression_id:null,lastRatio:0},_.set(s,r)),r.lastRatio=w.intersectionRatio||0,n&&!r.sent&&!r.timer&&(r.impression_id=r.impression_id||e.uuid(),r.timer=setTimeout(()=>{r.sent=!0,r.timer=null,e.enqueue(e.buildEvent("card_impression",{_event_id:e.uuid(),element_id:e.getElementId(s),impression_id:r.impression_id,viewport_percent:Math.round((r.lastRatio||0)*100)}))},g.minVisibleMs??300)),!n&&r.timer&&(clearTimeout(r.timer),r.timer=null),_.set(s,r)}},{threshold:[b]});try{u=new ResizeObserver(v=>{for(let w of v){let s=w.target;s&&(l.add(s),I(s))}})}catch{u=null}A(),l.forEach(v=>I(v)),t=new MutationObserver(()=>{A(),l.forEach(v=>I(v))});try{t.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}a=0,d=setInterval(()=>{a++,A(),l.forEach(v=>I(v)),a>=10&&(clearInterval(d),d=null)},1500)}function T(){try{t&&t.disconnect()}catch{}t=null;try{o&&o.disconnect()}catch{}o=null;try{u&&u.disconnect()}catch{}u=null,d&&(clearInterval(d),d=null),l.clear()}return{init(g){e=g,S()&&U()},onConfigChange(){S()?U():T()}}}function Oe(){let e=null,o=null,t=null,u=null,d=null,a=null,l=null,m=null,p={query:null,results_count:0,search_latency_ms:null,ts:0};function _(){return!!e?.state?.config?.plugins?.search}function S(){try{if(/search/i.test(location.pathname)||/search/i.test(location.href))return!0;let n=location.search||"";return/[?&](q|query|search)=/i.test(n)}catch{return!1}}function C(){if(S())return!0;let n=e?.state?.config?.search?.searchContextWindowMs??10*60*1e3;return!p?.query||!p?.ts?!1:e.now()-p.ts<=n}function L(n){let r=(n?.tagName||"").toLowerCase();if(r!=="input"&&r!=="textarea")return!1;let c=(n.getAttribute?.("type")||"").toLowerCase(),f=n.getAttribute?.("role")||"",x=n.getAttribute?.("name")||"",E=n.getAttribute?.("placeholder")||"";return f==="searchbox"||c==="search"||/search/i.test(x)||/search/i.test(E)}function P(n){try{let r=n?.closest?.("form")||null;if(r){let c=Array.from(r.querySelectorAll("input,textarea")).find(L);if(c)return c}return Array.from(document.querySelectorAll("input,textarea")).find(L)||null}catch{return null}}function A(n){try{if(!n)return!1;let r=(n.tagName||"").toLowerCase();if(!["button","a","div","span"].includes(r))return!1;let c=(n.getAttribute?.("type")||"").toLowerCase();if(r==="button"&&c==="submit"){let V=n.closest?.("form");if(V&&Array.from(V.querySelectorAll("input,textarea")).find(L))return!0}let f=(n.getAttribute?.("role")||"").toLowerCase(),x=(n.getAttribute?.("aria-label")||"").toLowerCase(),E=(n.getAttribute?.("title")||"").toLowerCase(),h=(n.getAttribute?.("data-elt")||n.getAttribute?.("data-testid")||"").toLowerCase(),k=(n.innerText||"").toLowerCase(),H=`${x} ${E} ${h} ${k}`.trim();return r==="button"&&(c==="submit"||c==="button")?/search|find|go/.test(H):f==="button"||f==="link"?/search|find|go/.test(H):r==="a"?/search|find|go/.test(H):!1}catch{return!1}}function I(n){try{if(!n||n.hidden)return!1;let r=window.getComputedStyle?getComputedStyle(n):null;if(r&&(r.display==="none"||r.visibility==="hidden"||r.opacity==="0")||n.getClientRects&&n.getClientRects().length===0)return!1;let c=n.getBoundingClientRect?.();return c?c.width>0&&c.height>0:!1}catch{return!0}}function U(){try{let n=e.state.config.search||{},r=document.querySelector(n.scopeSelector||"main")||document.body||document.documentElement,c=n.resultItemSelector||"article,[data-article-id],[data-content-id]",f=n.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",x=Array.from(r.querySelectorAll(c)),E=0;for(let h of x){if(!I(h)||h.closest?.("header,nav,footer")||f&&(h.matches?.(f)||h.closest?.(f)))continue;let k=h.getBoundingClientRect?.();k&&(k.width<80||k.height<40)||E++}return E}catch{return 0}}function T(){if(a){try{a.disconnect()}catch{}a=null}l&&(clearTimeout(l),l=null),m&&(clearTimeout(m),m=null)}function g(){o=null,t=null,u=null,d=null,T()}function b(n=!1){if(!o||!t)return!1;let r=e.state.config.search||{},c=Math.max(0,e.now()-t),f=U();return n||f>0&&c>=(r.minEmitMs??350)||c>=(r.maxWaitMs??4500)?(p={query:d||"",results_count:f,search_latency_ms:Math.round(c),ts:e.now()},e.enqueue(e.buildEvent("search",{_event_id:e.uuid(),element_id:u||"search_input",query:p.query,results_count:p.results_count,search_latency_ms:p.search_latency_ms})),g(),!0):!1}function v(){if(a)return;let n=e.state.config.search||{},r=document.querySelector(n.scopeSelector||"main")||document.body||document.documentElement;a=new MutationObserver(()=>{o&&(l&&clearTimeout(l),l=setTimeout(()=>{b(!1)},n.quietDebounceMs??220))});try{a.observe(r,{childList:!0,subtree:!0,attributes:!0})}catch{}}function w(){let n=e.state.config.search||{};if(!o||!t)return;let r=Math.max(0,e.now()-t),c=n.maxWaitMs??4500;if(!b(!1)){if(r>=c){b(!0);return}m=setTimeout(w,n.recheckIntervalMs??300)}}function s(n){if(!_())return;let r=e.sanitizeText(n?.value)||"";if(!r)return;o=e.uuid(),t=e.now(),u=e.getElementId(n)||"search_input",d=r,T(),v();let c=e.state.config.search||{};m=setTimeout(w,c.firstFallbackMs??2200)}function y(n){if(!_()||!C()||!p||(p.results_count||0)<=0)return;let r=e.state.config.search||{},c=document.querySelector(r.scopeSelector||"main")||document.body||document.documentElement,f=r.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",x=r.resultItemSelector||"article,[data-article-id],[data-content-id]",E=n.target,h=E?.closest?.("a,button,[role='link'],[role='button']")||E;if(!h||f&&(h.matches?.(f)||h.closest?.(f)))return;let k=h.closest?.(x);if(!k||f&&(k.matches?.(f)||k.closest?.(f)))return;let V=Array.from(c.querySelectorAll(x)).filter(z=>z&&I(z)&&!(f&&(z.matches?.(f)||z.closest?.(f)))).indexOf(k),ge=V>=0?V+1:null,Ve=k.getAttribute?.("data-article-id")||k.getAttribute?.("data-content-id")||k.getAttribute?.("data-result-id")||h.getAttribute?.("href")||null;e.enqueue(e.buildEvent("search_result_click",{_event_id:e.uuid(),element_id:e.getElementId(h),query:p.query,clicked_result_id:Ve,result_rank:ge,results_count:p.results_count}))}return{init(n){e=n,document.addEventListener("keydown",r=>{if(!_())return;let c=r.target;L(c)&&r.key==="Enter"&&s(c)},!0),document.addEventListener("submit",r=>{if(!_())return;let c=r.target;if(!c||c.nodeType!==1)return;let f=Array.from(c.querySelectorAll("input,textarea")).find(L);f&&s(f)},!0),document.addEventListener("click",r=>{if(!_())return;let c=r.target?.closest?.("button,a,[role='button'],[role='link'],div,span");if(!c||!A(c))return;let f=P(c);f&&s(f)},!0),document.addEventListener("click",y,!0)},onConfigChange(){_()||g()}}}function Pe(){let e=null,o=[/doubleclick\.net/i,/googlesyndication\.com/i,/adservice\.google/i,/googleadservices\.com/i,/gampad\/ads/i,/adnxs\.com/i,/criteo/i,/pubmatic\.com/i,/openx\.net/i],t=null,u=null,d=null,a=null,l=0,m=new Set,p=new WeakSet,_=new WeakSet,S=new Map;function C(){return!!e?.state?.config?.plugins?.ads}function L(s){try{let y=s?.tagName?.toLowerCase()==="iframe"?s:s?.closest?.("iframe");if(!y)return!1;let n=y.getAttribute("src")||"";return n?o.some(r=>r.test(n)):!1}catch{return!1}}function P(s){let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return s?.closest?.(n)||s?.closest?.("[role='advertisement']")||(s?.tagName?.toLowerCase()==="iframe"?s:s?.closest?.("iframe"))||null}function A(s){try{if(!s)return!1;let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return!!(s.closest?.(n)||s.closest?.("[role='advertisement']")||L(s))}catch{return!1}}function I(s){let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]",r=P(s);if(!r)return null;let c=r.closest?.(n)||(r.matches?.(n)?r:null),f=r.tagName?.toLowerCase()==="iframe"?r:r.querySelector?.("iframe")||null,x=r.closest?.("[role='advertisement']")||(r.matches?.("[role='advertisement']")?r:null),E=e.getElementId(c||x||f||r);return E?{element_id:E,ad_id:c?.getAttribute?.("data-ad-id")||null,ad_slot:c?.getAttribute?.("data-ad-slot")||null,ad_provider:c?.getAttribute?.("data-ad-provider")||null}:null}function U(s){try{let y=s.getBoundingClientRect?.();return y?y.width>=40&&y.height>=40:!1}catch{return!1}}function T(s){try{if(!t||!s||p.has(s))return;p.add(s),t.observe(s)}catch{}}function g(){if(!C())return;let y=(e.state.config.ads||{}).containerSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe";try{document.querySelectorAll(y).forEach(n=>{if(!(m.size>900)&&A(n)){if(d&&!_.has(n))try{d.observe(n),_.add(n)}catch{}U(n)&&m.add(n)}})}catch{}}function b(){if(!C()||t)return;let s=e.state.config.ads||{},y=s.threshold??.5;t=new IntersectionObserver(n=>{for(let r of n){let c=r.target;if(!c||!A(c))continue;let f=I(c);if(!f?.element_id)continue;let x=r.intersectionRatio||0,E=r.isIntersecting&&x>=y;S.has(f.element_id)||S.set(f.element_id,{impTimer:null,impSent:!1,viewStart:null,viewableSent:!1,lastRatio:0});let h=S.get(f.element_id);if(h.lastRatio=x,E&&!h.impSent&&!h.impTimer&&(h.impTimer=setTimeout(()=>{h.impSent=!0,h.impTimer=null,e.enqueue(e.buildEvent("ad_impression",{_event_id:e.uuid(),element_id:f.element_id,ad_id:f.ad_id,ad_slot:f.ad_slot,ad_provider:f.ad_provider}))},s.minVisibleMs??300)),!E&&h.impTimer&&(clearTimeout(h.impTimer),h.impTimer=null),E)h.viewStart===null&&(h.viewStart=e.now());else if(h.viewStart!==null&&!h.viewableSent){let k=e.now()-h.viewStart;h.viewStart=null,k>=(s.minViewableMs??1e3)&&(h.viewableSent=!0,e.enqueue(e.buildEvent("ad_viewable",{_event_id:e.uuid(),element_id:f.element_id,ad_id:f.ad_id,ad_slot:f.ad_slot,ad_provider:f.ad_provider,view_time_ms:k,viewable_percent:Math.round(h.lastRatio*100)})))}S.set(f.element_id,h)}},{threshold:[y]});try{d=new ResizeObserver(n=>{for(let r of n){let c=r.target;!c||!A(c)||U(c)&&(m.add(c),T(c))}})}catch{d=null}g(),m.forEach(n=>T(n)),u=new MutationObserver(()=>{g(),m.forEach(n=>T(n))});try{u.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}l=0,a=setInterval(()=>{l++,g(),m.forEach(n=>T(n)),l>=(s.rescanTicks??15)&&(clearInterval(a),a=null)},s.rescanIntervalMs??2e3)}function v(){try{u&&u.disconnect()}catch{}u=null;try{t&&t.disconnect()}catch{}t=null;try{d&&d.disconnect()}catch{}d=null,a&&(clearInterval(a),a=null),m.clear(),S.clear()}function w(s){if(!C())return;let y=s.target,n=y?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt],iframe,[role='advertisement'],[data-ad-id],[data-ad-slot],[data-ad-provider]")||y;if(!n||!A(n))return;let r=I(n);r?.element_id&&e.enqueue(e.buildEvent("ad_click",{_event_id:e.uuid(),element_id:r.element_id,ad_id:r.ad_id,ad_slot:r.ad_slot,ad_provider:r.ad_provider}))}return{init(s){e=s,document.addEventListener("click",w,!0),C()&&b()},onConfigChange(){C()?b():v()}}}function me(e){if(!Array.isArray(e))return;let[o,t]=e;if(o==="__meta"){i.meta.project_id=t?.project_id||i.meta.project_id,i.meta.cdnBase=t?.cdnBase||i.meta.cdnBase,i.meta.tagVersion=t?.tagVersion||i.meta.tagVersion;return}if(o==="config"){if(!t)return;if(t.collectUrl&&(i.config.collectUrl=t.collectUrl),typeof t.debug=="boolean"&&(i.config.debug=t.debug),typeof t.trackPageViews=="boolean"&&(i.config.trackPageViews=t.trackPageViews),typeof t.trackClicks=="boolean"&&(i.config.trackClicks=t.trackClicks),typeof t.trackScroll=="boolean"&&(i.config.trackScroll=t.trackScroll),typeof t.trackErrors=="boolean"&&(i.config.trackErrors=t.trackErrors),typeof t.includeQueryHash=="boolean"&&(i.config.includeQueryHash=t.includeQueryHash),typeof t.sampleRate=="number"&&(i.config.sampleRate=Math.max(0,Math.min(1,t.sampleRate)),de()),t.plugins&&typeof t.plugins=="object"){i.config.plugins=i.config.plugins||{};for(let u in t.plugins)typeof t.plugins[u]=="boolean"&&(i.config.plugins[u]=t.plugins[u])}t.cards&&typeof t.cards=="object"&&(i.config.cards=i.config.cards||{},Object.assign(i.config.cards,t.cards)),t.search&&typeof t.search=="object"&&(i.config.search=i.config.search||{},Object.assign(i.config.search,t.search)),t.ads&&typeof t.ads=="object"&&(i.config.ads=i.config.ads||{},Object.assign(i.config.ads,t.ads)),fe();return}if(o==="consent"){t&&typeof t.analytics=="boolean"&&(i.config.consentAnalytics=t.analytics),fe();return}if(o==="setUserId"){we(t);return}if(o==="event"){if(!t)return;let u=t.type||t.event_name;if(!u)return;let d=t.payload||t.properties||{},a=typeof t.event_ts=="number"?t.event_ts:void 0;O(q(u,{_event_id:M(),...d},{event_ts:a}));return}o==="flush"&&W({reason:"manual"})}function Ne(){i.entryReferrer=document.referrer||null,i.currentUrl=se(),i.previousUrl=null,ae(),de();let e=window[X]=window[X]||[];e.forEach(me);let o=e.push.bind(e);e.push=function(...t){return t.forEach(me),o(...t)},Le(),i.config.trackClicks&&document.addEventListener("click",Ae,!0),i.config.trackScroll&&Re(),window.addEventListener("pagehide",()=>W({reason:"pagehide"})),Te(),Y(qe()),Y(Oe()),Y(Pe()),Ue(),i.config.trackPageViews&&O(q("page_view",{trigger:"initial",_event_id:M()},{previous_url:null})),R("initialized",{project_id:i.meta.project_id,collectUrl:i.config.collectUrl,consent:i.config.consentAnalytics,sampledIn:i.sampledIn,includeQueryHash:i.config.includeQueryHash,plugins:i.config.plugins})}Ne()})();})();
