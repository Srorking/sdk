(()=>{(()=>{let $="__pt_sdk_loaded__";if(window[$])return;window[$]=!0;let he="0.2.2",X="_ptq",Z="__pt_anonymous_id",D="__pt_user_id",G="__pt_session_id",J="__pt_session_last",pe=30*60*1e3,ee=200,_e=5e3,ye=[25,50,75,100],te=80,r={meta:{project_id:null,cdnBase:null,tagVersion:null},config:{collectUrl:null,debug:!1,consentAnalytics:!0,trackPageViews:!0,trackClicks:!0,trackScroll:!0,trackErrors:!0,sampleRate:1,useBeaconOnUnload:!0,includeQueryHash:!1,plugins:{cards:!0,search:!1,ads:!1},cards:{threshold:.5,minVisibleMs:300,scopeSelector:"main",cardSelector:"article,[data-article-id],[data-content-id],[data-product-id],[data-item-id],[data-sku],.product,.product-card,.item,.card,[data-testid*='card']",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",minW:120,minH:80},search:{minEmitMs:350,maxWaitMs:4500,quietDebounceMs:220,recheckIntervalMs:300,firstFallbackMs:2200,scopeSelector:"main",resultItemSelector:"article,[data-article-id],[data-content-id],[data-result],.search-result,.result,[data-testid*='result'],.product,.product-card,.item,.card,[data-product-id],[data-sku],[data-item-id]",adExcludeSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",searchContextWindowMs:10*60*1e3},ads:{threshold:.5,minVisibleMs:300,minViewableMs:1e3,rescanIntervalMs:2e3,rescanTicks:15,containerSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe",dataSelector:"[data-ad-id],[data-ad-slot],[data-ad-provider]"}},sampleSeed:null,sampledIn:!0,userId:null,entryReferrer:null,currentUrl:null,previousUrl:null,webVitals:{}};function j(){return Date.now()}function M(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let o=Math.random()*16|0;return(e==="x"?o:o&3|8).toString(16)})}function B(e){return!e||typeof e!="string"||(e=e.replace(/\s+/g," ").trim(),!e)?null:(e.length>te&&(e=e.slice(0,te)+"\u2026"),e=e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[redacted_email]"),e=e.replace(/\+?\d[\d\s\-()]{7,}\d/g,"[redacted_phone]"),e)}function ne(e){try{return localStorage.getItem(e)}catch{return null}}function re(e,o){try{localStorage.setItem(e,o)}catch{}}function be(e){try{localStorage.removeItem(e)}catch{}}function ie(e){try{return sessionStorage.getItem(e)}catch{return null}}function oe(e,o){try{sessionStorage.setItem(e,o)}catch{}}function ve(){let e=ne(Z);return e||(e=M(),re(Z,e)),e}function we(){try{let e=j(),o=Number(ie(J)||0),t=ie(G);return(!t||!o||e-o>pe)&&(t=M(),oe(G,t)),oe(J,String(e)),t}catch{return M()}}function ae(){if(r.userId)return r.userId;let e=ne(D);return r.userId=e?String(e):null,r.userId}function Se(e){if(e==null||e===""){r.userId=null,be(D);return}r.userId=String(e),re(D,r.userId)}function se(){if(r.config.includeQueryHash)return window.location.href;let e=new URL(window.location.href);return e.search="",e.hash="",e.toString()}function Ee(){return{ua:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screen:{w:window.screen.width,h:window.screen.height,dpr:window.devicePixelRatio||1},viewport:{w:window.innerWidth,h:window.innerHeight},sdk_version:he,tag_version:r.meta.tagVersion||null}}function O(e,o={},t={}){let l=se(),u=t.previous_url!==void 0?t.previous_url:r.previousUrl||null,a=typeof t.event_ts=="number"?t.event_ts:j();return{project_id:r.meta.project_id,event_name:e,event_ts:a,anonymous_id:ve(),session_id:we(),user_id:ae(),page_url:l,page_path:window.location.pathname,page_title:document.title,referrer:r.entryReferrer||document.referrer||null,previous_url:u,context:Ee(),properties:o,web_vitals:r.webVitals||{}}}let N=[],F=null;function R(...e){r.config.debug&&console.log("[pt-sdk]",...e)}function ce(){return r.sampledIn&&r.config.consentAnalytics!==!1&&!!r.meta.project_id&&!!r.config.collectUrl}function q(e){if(ce()){if(r.config.debug)try{console.log("%cPT_EVT","font-weight:bold;color:#00b894",e.event_name,e)}catch{}N.push(e),N.length>=20?W({reason:"size"}):ke()}}function ke(){F||(F=setTimeout(()=>{F=null,W({reason:"timer"})},_e))}function xe(e,{useBeacon:o=!1}={}){if(window.__pt_debug_events=window.__pt_debug_events||[],window.__pt_debug_events.push(e),o&&navigator.sendBeacon)try{let t=new Blob([JSON.stringify(e)],{type:"application/json"}),l=navigator.sendBeacon(r.config.collectUrl,t);R("beacon sent:",l,e);return}catch(t){R("beacon failed, fallback to fetch",t)}fetch(r.config.collectUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).then(async t=>{if(t.ok)R("collect ok:",t.status,"events:",e.events?.length);else{let l=await t.text().catch(()=>"");R("collect non-2xx:",t.status,l)}}).catch(t=>R("collect failed:",t))}function W({reason:e}={}){if(!N.length||!ce())return;let o=N.splice(0,N.length),t=[];for(let u=0;u<o.length;u+=ee)t.push(o.slice(u,u+ee));let l=r.config.useBeaconOnUnload&&(e==="pagehide"||e==="hidden");t.forEach(u=>{let a={project_id:r.meta.project_id,sent_at:j(),events:u};xe(a,{useBeacon:l})})}function Ce(e){if(!e||!e.tagName)return null;let o=[],t=e;for(let l=0;l<4&&t&&t.tagName;l++){let u=t.tagName.toLowerCase();if(t.id){u+=`#${t.id}`,o.unshift(u);break}t.classList&&t.classList.length&&(u+="."+Array.from(t.classList).slice(0,2).join(".")),o.unshift(u),t=t.parentElement}return o.join(">")}function Q(e){let o=e?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e;if(!o)return null;let t=o.closest?.("[data-elt]")||o,l=t.getAttribute?.("data-elt")||t.getAttribute?.("data-testid")||t.getAttribute?.("aria-label")||Ce(t);return B(String(l||""))||l||null}function Ae(e){if(!r.config.trackClicks)return;let o=Q(e.target),t=e.target?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt]")||e.target;q(O("click",{_event_id:M(),element_id:o,element_type:t?.tagName?t.tagName.toLowerCase():null,element_role:t?.getAttribute?.("role")||t?.getAttribute?.("data-role")||null,x:e.clientX,y:e.clientY,button:e.button}))}let le=new Set;function Ie(){try{let e=r.config.scrollContainerSelector;if(e){let o=document.querySelector(e);if(o)return o}}catch{}return document.documentElement}function Me(){let e=Ie(),o=e.scrollTop||0,t=e.scrollHeight||0,l=e.clientHeight||1,u=Math.max(1,t-l),a=o/u*100;return Math.max(0,Math.min(100,a))}function ue(){if(!r.config.trackScroll)return;let e=Me(),o=Math.floor(e+.5);for(let t of ye)o>=t&&!le.has(t)&&(le.add(t),q(O("scroll",{_event_id:M(),scroll_depth:t})))}function Re(){window.addEventListener("scroll",ue,{passive:!0});try{let e=r.config.scrollContainerSelector;if(e){let o=document.querySelector(e);o&&o.addEventListener("scroll",ue,{passive:!0})}}catch{}}function Le(){try{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart&&(r.webVitals.ttfb=Math.round(e.responseStart)),window.PerformanceObserver){new PerformanceObserver(d=>{d.getEntries().forEach(m=>{m.name==="first-contentful-paint"&&(r.webVitals.fcp=Math.round(m.startTime))})}).observe({type:"paint",buffered:!0}),new PerformanceObserver(d=>{let m=d.getEntries(),p=m[m.length-1];p&&(r.webVitals.lcp=Math.round(p.startTime))}).observe({type:"largest-contentful-paint",buffered:!0});let l=0;new PerformanceObserver(d=>{d.getEntries().forEach(m=>{m.hadRecentInput||(l+=m.value)}),r.webVitals.cls=Number(l.toFixed(4))}).observe({type:"layout-shift",buffered:!0});let a=new PerformanceObserver(d=>{let m=d.getEntries()[0];m&&(r.webVitals.fid=Math.round(m.processingStart-m.startTime))});Te(),a.observe({type:"first-input",buffered:!0})}}catch{}}function Te(){try{if(!window.PerformanceObserver)return;let e=0;new PerformanceObserver(t=>{let l=t.getEntries();for(let u of l){if(!u||!u.interactionId)continue;let a=Math.round(u.duration||0);a>e&&(e=a)}r.webVitals.inp=e}).observe({type:"event",buffered:!0})}catch{}}function de(){(r.sampleSeed===null||r.sampleSeed===void 0)&&(r.sampleSeed=Math.random());let e=typeof r.config.sampleRate=="number"?r.config.sampleRate:1,o=Math.max(0,Math.min(1,e));r.sampledIn=r.sampleSeed<o}function Ue(){if(!r.config.trackErrors)return;let e=new Set,o=a=>{try{let d=JSON.stringify(a);return d.length>800?d.slice(0,800):d}catch{return String(a)}},t=a=>{try{if(a==null)return null;let d=String(a).trim();return d?(d.length>500&&(d=d.slice(0,500)+"\u2026"),d):null}catch{return null}},l=(a,d)=>{try{let m=a||d?.fileName||d?.sourceURL||d?.scriptURL||null;if(m)return m;let p=String(d?.stack||"");if(!p)return null;let _=p.match(/(https?:\/\/[^\s)]+|file:\/\/[^\s)]+)/i);if(_&&_[1])return _[1];let w=p.match(/(\b\/[^\s)]+):\d+:\d+/);return w&&w[1]?w[1]:null}catch{return null}},u=a=>{let d=o(a);e.has(d)||(e.add(d),q(O("error",{_event_id:M(),...a})))};window.addEventListener("error",a=>{try{if(!a.message&&(a.target||a.srcElement)){let _=a.target||a.srcElement,w=_?.currentSrc||_?.src||_?.href||_?.getAttribute?.("src")||_?.getAttribute?.("href")||null,C=t(w);u({error_type:"resource",message:"resource_load_error",source_url:C,resource_url:C,resource_tag:(_?.tagName||"").toLowerCase()||null,element_id:Q(_)||null,is_fatal:!1});return}let m=B(a?.message)||"js_error",p=t(l(a?.filename,a?.error))||t(a?.filename)||null;u({error_type:"js",message:m,filename:a?.filename||null,lineno:a?.lineno||null,colno:a?.colno||null,source_url:p,is_fatal:!1})}catch{u({error_type:"js",message:"js_error",source_url:null,is_fatal:!1})}},!0),window.addEventListener("unhandledrejection",a=>{try{let d=a?.reason?.message||String(a?.reason||""),m=B(d)||"unhandled_promise",p=t(l(null,a?.reason))||null;u({error_type:"unhandledrejection",message:m,source_url:p,is_fatal:!1})}catch{u({error_type:"unhandledrejection",message:"unhandled_promise",source_url:null,is_fatal:!1})}})}let K=[];function Y(e){e&&typeof e.init=="function"&&K.push(e)}function Oe(){let e={state:r,enqueue:q,buildEvent:O,uuid:M,sanitizeText:B,getElementId:Q,dbg:R,now:j};K.forEach(o=>{try{o.init(e)}catch(t){R("plugin init failed",t)}})}function fe(){K.forEach(e=>{try{e.onConfigChange?.(r.config)}catch(o){R("plugin onConfigChange failed",o)}})}function qe(){let e=null,o=null,t=null,l=null,u=null,a=0,d=new Set,m=new WeakSet,p=new WeakSet,_=new WeakMap;function w(){return e?.state?.config?.plugins?.cards!==!1}function C(g){try{if(!g||g.hidden)return!1;let b=window.getComputedStyle?getComputedStyle(g):null;if(b&&(b.display==="none"||b.visibility==="hidden"||b.opacity==="0")||g.getClientRects&&g.getClientRects().length===0)return!1;let v=g.getBoundingClientRect?.();return v?v.width>0&&v.height>0:!1}catch{return!0}}function L(g,b,v){try{let S=g.getBoundingClientRect?.();return S?S.width>=b&&S.height>=v:!1}catch{return!1}}function P(g,b){try{return b?!!(g?.matches?.(b)||g?.closest?.(b)):!1}catch{return!1}}function A(){if(!w())return;let g=e.state.config.cards||{},b=document.querySelector(g.scopeSelector||"main")||document.body||document.documentElement,v=g.cardSelector||"article",S=g.adExcludeSelector||null,s=g.minW??120,y=g.minH??80;try{b.querySelectorAll(v).forEach(n=>{if(!(d.size>1e3)&&C(n)&&L(n,s,y)&&!P(n,S)&&(d.add(n),l&&!p.has(n)))try{l.observe(n),p.add(n)}catch{}})}catch{}}function I(g){try{if(!o||!g||m.has(g))return;m.add(g),o.observe(g)}catch{}}function U(){if(!w()||o)return;let g=e.state.config.cards||{},b=g.threshold??.5;o=new IntersectionObserver(v=>{for(let S of v){let s=S.target;if(!s)continue;let y=g.adExcludeSelector||null;if(P(s,y))continue;let n=S.isIntersecting&&(S.intersectionRatio||0)>=b,i=_.get(s);i||(i={timer:null,sent:!1,impression_id:null,lastRatio:0},_.set(s,i)),i.lastRatio=S.intersectionRatio||0,n&&!i.sent&&!i.timer&&(i.impression_id=i.impression_id||e.uuid(),i.timer=setTimeout(()=>{i.sent=!0,i.timer=null,e.enqueue(e.buildEvent("card_impression",{_event_id:e.uuid(),element_id:e.getElementId(s),impression_id:i.impression_id,viewport_percent:Math.round((i.lastRatio||0)*100)}))},g.minVisibleMs??300)),!n&&i.timer&&(clearTimeout(i.timer),i.timer=null),_.set(s,i)}},{threshold:[b]});try{l=new ResizeObserver(v=>{for(let S of v){let s=S.target;s&&(d.add(s),I(s))}})}catch{l=null}A(),d.forEach(v=>I(v)),t=new MutationObserver(()=>{A(),d.forEach(v=>I(v))});try{t.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}a=0,u=setInterval(()=>{a++,A(),d.forEach(v=>I(v)),a>=10&&(clearInterval(u),u=null)},1500)}function T(){try{t&&t.disconnect()}catch{}t=null;try{o&&o.disconnect()}catch{}o=null;try{l&&l.disconnect()}catch{}l=null,u&&(clearInterval(u),u=null),d.clear()}return{init(g){e=g,w()&&U()},onConfigChange(){w()?U():T()}}}function Pe(){let e=null,o=null,t=null,l=null,u=null,a=null,d=null,m=null,p={query:null,results_count:0,search_latency_ms:null,ts:0};function _(){return!!e?.state?.config?.plugins?.search}function w(){try{if(/search/i.test(location.pathname)||/search/i.test(location.href))return!0;let n=location.search||"";return/[?&](q|query|search)=/i.test(n)}catch{return!1}}function C(){if(w())return!0;let n=e?.state?.config?.search?.searchContextWindowMs??10*60*1e3;return!p?.query||!p?.ts?!1:e.now()-p.ts<=n}function L(n){let i=(n?.tagName||"").toLowerCase();if(i!=="input"&&i!=="textarea")return!1;let c=(n.getAttribute?.("type")||"").toLowerCase(),f=n.getAttribute?.("role")||"",x=n.getAttribute?.("name")||"",E=n.getAttribute?.("placeholder")||"";return f==="searchbox"||c==="search"||/search/i.test(x)||/search/i.test(E)}function P(n){try{let i=n?.closest?.("form")||null;if(i){let c=Array.from(i.querySelectorAll("input,textarea")).find(L);if(c)return c}return Array.from(document.querySelectorAll("input,textarea")).find(L)||null}catch{return null}}function A(n){try{if(!n)return!1;let i=(n.tagName||"").toLowerCase();if(!["button","a","div","span"].includes(i))return!1;let c=(n.getAttribute?.("type")||"").toLowerCase();if(i==="button"&&c==="submit"){let V=n.closest?.("form");if(V&&Array.from(V.querySelectorAll("input,textarea")).find(L))return!0}let f=(n.getAttribute?.("role")||"").toLowerCase(),x=(n.getAttribute?.("aria-label")||"").toLowerCase(),E=(n.getAttribute?.("title")||"").toLowerCase(),h=(n.getAttribute?.("data-elt")||n.getAttribute?.("data-testid")||"").toLowerCase(),k=(n.innerText||"").toLowerCase(),H=`${x} ${E} ${h} ${k}`.trim();return i==="button"&&(c==="submit"||c==="button")?/search|find|go/.test(H):f==="button"||f==="link"?/search|find|go/.test(H):i==="a"?/search|find|go/.test(H):!1}catch{return!1}}function I(n){try{if(!n||n.hidden)return!1;let i=window.getComputedStyle?getComputedStyle(n):null;if(i&&(i.display==="none"||i.visibility==="hidden"||i.opacity==="0")||n.getClientRects&&n.getClientRects().length===0)return!1;let c=n.getBoundingClientRect?.();return c?c.width>0&&c.height>0:!1}catch{return!0}}function U(){try{let n=e.state.config.search||{},i=document.querySelector(n.scopeSelector||"main")||document.body||document.documentElement,c=n.resultItemSelector||"article,[data-article-id],[data-content-id]",f=n.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",x=Array.from(i.querySelectorAll(c)),E=0;for(let h of x){if(!I(h)||h.closest?.("header,nav,footer")||f&&(h.matches?.(f)||h.closest?.(f)))continue;let k=h.getBoundingClientRect?.();k&&(k.width<80||k.height<40)||E++}return E}catch{return 0}}function T(){if(a){try{a.disconnect()}catch{}a=null}d&&(clearTimeout(d),d=null),m&&(clearTimeout(m),m=null)}function g(){o=null,t=null,l=null,u=null,T()}function b(n=!1){if(!o||!t)return!1;let i=e.state.config.search||{},c=Math.max(0,e.now()-t),f=U();return n||f>0&&c>=(i.minEmitMs??350)||c>=(i.maxWaitMs??4500)?(p={query:u||"",results_count:f,search_latency_ms:Math.round(c),ts:e.now()},e.enqueue(e.buildEvent("search",{_event_id:e.uuid(),element_id:l||"search_input",query:p.query,results_count:p.results_count,search_latency_ms:p.search_latency_ms})),g(),!0):!1}function v(){if(a)return;let n=e.state.config.search||{},i=document.querySelector(n.scopeSelector||"main")||document.body||document.documentElement;a=new MutationObserver(()=>{o&&(d&&clearTimeout(d),d=setTimeout(()=>{b(!1)},n.quietDebounceMs??220))});try{a.observe(i,{childList:!0,subtree:!0,attributes:!0})}catch{}}function S(){let n=e.state.config.search||{};if(!o||!t)return;let i=Math.max(0,e.now()-t),c=n.maxWaitMs??4500;if(!b(!1)){if(i>=c){b(!0);return}m=setTimeout(S,n.recheckIntervalMs??300)}}function s(n){if(!_())return;let i=e.sanitizeText(n?.value)||"";if(!i)return;o=e.uuid(),t=e.now(),l=e.getElementId(n)||"search_input",u=i,T(),v();let c=e.state.config.search||{};m=setTimeout(S,c.firstFallbackMs??2200)}function y(n){if(!_()||!C()||!p||(p.results_count||0)<=0)return;let i=e.state.config.search||{},c=document.querySelector(i.scopeSelector||"main")||document.body||document.documentElement,f=i.adExcludeSelector||"[data-ad-id],[role='advertisement'],iframe",x=i.resultItemSelector||"article,[data-article-id],[data-content-id]",E=n.target,h=E?.closest?.("a,button,[role='link'],[role='button']")||E;if(!h||f&&(h.matches?.(f)||h.closest?.(f)))return;let k=h.closest?.(x);if(!k||f&&(k.matches?.(f)||k.closest?.(f)))return;let V=Array.from(c.querySelectorAll(x)).filter(z=>z&&I(z)&&!(f&&(z.matches?.(f)||z.closest?.(f)))).indexOf(k),ge=V>=0?V+1:null,je=k.getAttribute?.("data-article-id")||k.getAttribute?.("data-content-id")||k.getAttribute?.("data-result-id")||h.getAttribute?.("href")||null;e.enqueue(e.buildEvent("search_result_click",{_event_id:e.uuid(),element_id:e.getElementId(h),query:p.query,clicked_result_id:je,result_rank:ge,results_count:p.results_count}))}return{init(n){e=n,document.addEventListener("keydown",i=>{if(!_())return;let c=i.target;L(c)&&i.key==="Enter"&&s(c)},!0),document.addEventListener("submit",i=>{if(!_())return;let c=i.target;if(!c||c.nodeType!==1)return;let f=Array.from(c.querySelectorAll("input,textarea")).find(L);f&&s(f)},!0),document.addEventListener("click",i=>{if(!_())return;let c=i.target?.closest?.("button,a,[role='button'],[role='link'],div,span");if(!c||!A(c))return;let f=P(c);f&&s(f)},!0),document.addEventListener("click",y,!0)},onConfigChange(){_()||g()}}}function Ne(){let e=null,o=[/doubleclick\.net/i,/googlesyndication\.com/i,/adservice\.google/i,/googleadservices\.com/i,/gampad\/ads/i,/adnxs\.com/i,/criteo/i,/pubmatic\.com/i,/openx\.net/i],t=null,l=null,u=null,a=null,d=0,m=new Set,p=new WeakSet,_=new WeakSet,w=new Map;function C(){return!!e?.state?.config?.plugins?.ads}function L(s){try{let y=s?.tagName?.toLowerCase()==="iframe"?s:s?.closest?.("iframe");if(!y)return!1;let n=y.getAttribute("src")||"";return n?o.some(i=>i.test(n)):!1}catch{return!1}}function P(s){let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return s?.closest?.(n)||s?.closest?.("[role='advertisement']")||(s?.tagName?.toLowerCase()==="iframe"?s:s?.closest?.("iframe"))||null}function A(s){try{if(!s)return!1;let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]";return!!(s.closest?.(n)||s.closest?.("[role='advertisement']")||L(s))}catch{return!1}}function I(s){let n=(e.state.config.ads||{}).dataSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider]",i=P(s);if(!i)return null;let c=i.closest?.(n)||(i.matches?.(n)?i:null),f=i.tagName?.toLowerCase()==="iframe"?i:i.querySelector?.("iframe")||null,x=i.closest?.("[role='advertisement']")||(i.matches?.("[role='advertisement']")?i:null),E=e.getElementId(c||x||f||i);return E?{element_id:E,ad_id:c?.getAttribute?.("data-ad-id")||null,ad_slot:c?.getAttribute?.("data-ad-slot")||null,ad_provider:c?.getAttribute?.("data-ad-provider")||null}:null}function U(s){try{let y=s.getBoundingClientRect?.();return y?y.width>=40&&y.height>=40:!1}catch{return!1}}function T(s){try{if(!t||!s||p.has(s))return;p.add(s),t.observe(s)}catch{}}function g(){if(!C())return;let y=(e.state.config.ads||{}).containerSelector||"[data-ad-id],[data-ad-slot],[data-ad-provider],[role='advertisement'],iframe";try{document.querySelectorAll(y).forEach(n=>{if(!(m.size>900)&&A(n)){if(u&&!_.has(n))try{u.observe(n),_.add(n)}catch{}U(n)&&m.add(n)}})}catch{}}function b(){if(!C()||t)return;let s=e.state.config.ads||{},y=s.threshold??.5;t=new IntersectionObserver(n=>{for(let i of n){let c=i.target;if(!c||!A(c))continue;let f=I(c);if(!f?.element_id)continue;let x=i.intersectionRatio||0,E=i.isIntersecting&&x>=y;w.has(f.element_id)||w.set(f.element_id,{impTimer:null,impSent:!1,viewStart:null,viewableSent:!1,lastRatio:0});let h=w.get(f.element_id);if(h.lastRatio=x,E&&!h.impSent&&!h.impTimer&&(h.impTimer=setTimeout(()=>{h.impSent=!0,h.impTimer=null,e.enqueue(e.buildEvent("ad_impression",{_event_id:e.uuid(),element_id:f.element_id,ad_id:f.ad_id,ad_slot:f.ad_slot,ad_provider:f.ad_provider}))},s.minVisibleMs??300)),!E&&h.impTimer&&(clearTimeout(h.impTimer),h.impTimer=null),E)h.viewStart===null&&(h.viewStart=e.now());else if(h.viewStart!==null&&!h.viewableSent){let k=e.now()-h.viewStart;h.viewStart=null,k>=(s.minViewableMs??1e3)&&(h.viewableSent=!0,e.enqueue(e.buildEvent("ad_viewable",{_event_id:e.uuid(),element_id:f.element_id,ad_id:f.ad_id,ad_slot:f.ad_slot,ad_provider:f.ad_provider,view_time_ms:k,viewable_percent:Math.round(h.lastRatio*100)})))}w.set(f.element_id,h)}},{threshold:[y]});try{u=new ResizeObserver(n=>{for(let i of n){let c=i.target;!c||!A(c)||U(c)&&(m.add(c),T(c))}})}catch{u=null}g(),m.forEach(n=>T(n)),l=new MutationObserver(()=>{g(),m.forEach(n=>T(n))});try{l.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}catch{}d=0,a=setInterval(()=>{d++,g(),m.forEach(n=>T(n)),d>=(s.rescanTicks??15)&&(clearInterval(a),a=null)},s.rescanIntervalMs??2e3)}function v(){try{l&&l.disconnect()}catch{}l=null;try{t&&t.disconnect()}catch{}t=null;try{u&&u.disconnect()}catch{}u=null,a&&(clearInterval(a),a=null),m.clear(),w.clear()}function S(s){if(!C())return;let y=s.target,n=y?.closest?.("a,button,input,textarea,select,[role='button'],[role='link'],[data-elt],iframe,[role='advertisement'],[data-ad-id],[data-ad-slot],[data-ad-provider]")||y;if(!n||!A(n))return;let i=I(n);i?.element_id&&e.enqueue(e.buildEvent("ad_click",{_event_id:e.uuid(),element_id:i.element_id,ad_id:i.ad_id,ad_slot:i.ad_slot,ad_provider:i.ad_provider}))}return{init(s){e=s,document.addEventListener("click",S,!0),C()&&b()},onConfigChange(){C()?b():v()}}}function me(e){if(!Array.isArray(e))return;let[o,t]=e;if(o==="__meta"){r.meta.project_id=t?.project_id||r.meta.project_id,r.meta.cdnBase=t?.cdnBase||r.meta.cdnBase,r.meta.tagVersion=t?.tagVersion||r.meta.tagVersion;return}if(o==="config"){if(!t)return;if(t.collectUrl&&(r.config.collectUrl=t.collectUrl),typeof t.debug=="boolean"&&(r.config.debug=t.debug),typeof t.trackPageViews=="boolean"&&(r.config.trackPageViews=t.trackPageViews),typeof t.trackClicks=="boolean"&&(r.config.trackClicks=t.trackClicks),typeof t.trackScroll=="boolean"&&(r.config.trackScroll=t.trackScroll),typeof t.trackErrors=="boolean"&&(r.config.trackErrors=t.trackErrors),typeof t.includeQueryHash=="boolean"&&(r.config.includeQueryHash=t.includeQueryHash),typeof t.sampleRate=="number"&&(r.config.sampleRate=Math.max(0,Math.min(1,t.sampleRate)),de()),t.plugins&&typeof t.plugins=="object"){r.config.plugins=r.config.plugins||{};for(let l in t.plugins)typeof t.plugins[l]=="boolean"&&(r.config.plugins[l]=t.plugins[l])}t.cards&&typeof t.cards=="object"&&(r.config.cards=r.config.cards||{},Object.assign(r.config.cards,t.cards)),t.search&&typeof t.search=="object"&&(r.config.search=r.config.search||{},Object.assign(r.config.search,t.search)),t.ads&&typeof t.ads=="object"&&(r.config.ads=r.config.ads||{},Object.assign(r.config.ads,t.ads)),fe();return}if(o==="consent"){t&&typeof t.analytics=="boolean"&&(r.config.consentAnalytics=t.analytics),fe();return}if(o==="setUserId"){Se(t);return}if(o==="event"){if(!t)return;let l=t.type||t.event_name;if(!l)return;let u=t.payload||t.properties||{},a=typeof t.event_ts=="number"?t.event_ts:void 0;q(O(l,{_event_id:M(),...u},{event_ts:a}));return}o==="flush"&&W({reason:"manual"})}function Ve(){r.entryReferrer=document.referrer||null,r.currentUrl=se(),r.previousUrl=null,ae(),de();let e=window[X]=window[X]||[];e.forEach(me);let o=e.push.bind(e);e.push=function(...t){return t.forEach(me),o(...t)},Le(),r.config.trackClicks&&document.addEventListener("click",Ae,!0),r.config.trackScroll&&Re(),window.addEventListener("pagehide",()=>W({reason:"pagehide"})),Ue(),Y(qe()),Y(Pe()),Y(Ne()),Oe(),r.config.trackPageViews&&q(O("page_view",{trigger:"initial",_event_id:M()},{previous_url:null})),R("initialized",{project_id:r.meta.project_id,collectUrl:r.config.collectUrl,consent:r.config.consentAnalytics,sampledIn:r.sampledIn,includeQueryHash:r.config.includeQueryHash,plugins:r.config.plugins})}Ve()})();})();
